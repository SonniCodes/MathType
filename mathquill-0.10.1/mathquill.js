!function () { var u, f = window.jQuery, r = "mathquill-command-id", p = "mathquill-block-id", d = Math.min, o = Math.max; function m() { } var s = [].slice; function e(n) { var i = n.length - 1; return function () { var t = s.call(arguments, 0, i), e = s.call(arguments, i); return n.apply(this, t.concat([e])) } } var i = e(function (n, i) { return e(function (t, e) { if (n in t) return t[n].apply(t, i.concat(e)) }) }); function n(t) { return e(function (e, n) { "function" != typeof e && (e = i(e)); return t.call(this, function (t) { return e.apply(t, [t].concat(n)) }) }) } function a(t) { var e = s.call(arguments, 1); return function () { return t.apply(this, e) } } function c(t, e) { if (!e) throw new Error("prayer failed: " + t) } var l, h, g = (l = "prototype", h = {}.hasOwnProperty, function e(n, t) { function i() { var t = new s; return b(t.init) && t.init.apply(t, arguments), t } function s() { } void 0 === t && (t = n, n = Object), i.Bare = s; var r, o = w[l] = n[l], a = s[l] = i[l] = i.p = new w; return (a.constructor = i).mixin = function (t) { return s[l] = i[l] = e(i, t)[l], i }, (i.open = function (t) { if (r = {}, b(t) ? r = t.call(i, a, o, i, n) : v(t) && (r = t), v(r)) for (var e in r) h.call(r, e) && (a[e] = r[e]); return b(a.init) || (a.init = n), i })(t) }); function v(t) { return "object" == typeof t } function b(t) { return "function" == typeof t } function w() { } var x = -1, q = 1; function y(t) { c("a direction was passed", t === x || t === q) } var O = g(f, function (t) { t.insDirOf = function (t, e) { return t === x ? this.insertBefore(e.first()) : this.insertAfter(e.last()) }, t.insAtDirEnd = function (t, e) { return t === x ? this.prependTo(e) : this.appendTo(e) } }), k = g(function (t) { t.parent = 0, t[x] = 0, t[q] = 0, t.init = function (t, e, n) { this.parent = t, this[x] = e, this[q] = n }, this.copy = function (t) { return k(t.parent, t[x], t[q]) } }), C = g(function (t) { t[x] = 0, t[q] = 0; var e = t.parent = 0; this.byId = {}, t.init = function () { this.id = e += 1, (C.byId[this.id] = this).ends = {}, this.ends[x] = 0, this.ends[q] = 0 }, t.dispose = function () { delete C.byId[this.id] }, t.toString = function () { return "{{ MathQuill Node #" + this.id + " }}" }, t.jQ = O(), t.jQadd = function (t) { return this.jQ = this.jQ.add(t) }, t.jQize = function (t) { t = O(t || this.html()); for (var e = 0; e < t.length; e += 1)!function t(e) { var n, i; for (e.getAttribute && (n = e.getAttribute("mathquill-command-id"), i = e.getAttribute("mathquill-block-id"), n && C.byId[n].jQadd(e), i && C.byId[i].jQadd(e)), e = e.firstChild; e; e = e.nextSibling)t(e) }(t[e]); return t }, t.createDir = function (t, e) { y(t); return this.jQize(), this.jQ.insDirOf(t, e.jQ), e[t] = this.adopt(e.parent, e[x], e[q]), this }, t.createLeftOf = function (t) { return this.createDir(x, t) }, t.selectChildren = function (t, e) { return S(t, e) }, t.bubble = n(function (t) { for (var e = this; e; e = e.parent)if (!1 === t(e)) break; return this }), t.postOrder = n(function (n) { return function t(e) { e.eachChild(t), n(e) }(this), this }), t.isEmpty = function () { return 0 === this.ends[x] && 0 === this.ends[q] }, t.children = function () { return j(this.ends[x], this.ends[q]) }, t.eachChild = function () { var t = this.children(); return t.each.apply(t, arguments), this }, t.foldChildren = function (t, e) { return this.children().fold(t, e) }, t.withDirAdopt = function (t, e, n, i) { return j(this, this).withDirAdopt(t, e, n, i), this }, t.adopt = function (t, e, n) { return j(this, this).adopt(t, e, n), this }, t.disown = function () { return j(this, this).disown(), this }, t.remove = function () { return this.jQ.remove(), this.postOrder("dispose"), this.disown() } }); function T(t, e, n) { c("a parent is always present", t), c("leftward is properly set up", e ? e[q] === n && e.parent === t : t.ends[x] === n), c("rightward is properly set up", n ? n[x] === e && n.parent === t : t.ends[q] === e) } var j = g(function (t) { t.init = function (t, e, n) { n === u && (n = x), y(n), c("no half-empty fragments", !t == !e), this.ends = {}, t && (c("withDir is passed to Fragment", t instanceof C), c("oppDir is passed to Fragment", e instanceof C), c("withDir and oppDir have the same parent", t.parent === e.parent), this.ends[n] = t, this.ends[-n] = e, e = this.fold([], function (t, e) { return t.push.apply(t, e.jQ.get()), t }), this.jQ = this.jQ.add(e)) }, t.jQ = O(), t.withDirAdopt = function (t, e, n, i) { return t === x ? this.adopt(e, n, i) : this.adopt(e, i, n) }, t.adopt = function (e, n, t) { T(e, n, t); var i = this; i.disowned = !1; var s = i.ends[x]; if (!s) return this; var r = i.ends[q]; return n || (e.ends[x] = s), t ? t[x] = r : e.ends[q] = r, i.ends[q][q] = t, i.each(function (t) { t[x] = n, t.parent = e, n && (n[q] = t), n = t }), i }, t.disown = function () { var t = this, e = t.ends[x]; if (!e || t.disowned) return t; t.disowned = !0; var n = t.ends[q], i = e.parent; return T(i, e[x], e), T(i, n, n[q]), e[x] ? e[x][q] = n[q] : i.ends[x] = n[q], n[q] ? n[q][x] = e[x] : i.ends[q] = e[x], t }, t.remove = function () { return this.jQ.remove(), this.each("postOrder", "dispose"), this.disown() }, t.each = n(function (t) { var e = this.ends[x]; if (!e) return this; for (; e !== this.ends[q][q]; e = e[q])if (!1 === t(e)) break; return this }), t.fold = function (e, n) { return this.each(function (t) { e = n.call(this, e, t) }), e } }), Q = {}, _ = {}, D = g(k, function (t) { t.init = function (t, e) { this.parent = t, this.options = e; var n = this.jQ = this._jQ = O('<span class="mq-cursor">&#8203;</span>'); this.blink = function () { n.toggleClass("mq-blink") }, this.upDownCache = {} }, t.show = function () { return this.jQ = this._jQ.removeClass("mq-blink"), "intervalId" in this ? clearInterval(this.intervalId) : (this[q] ? this.selection && this.selection.ends[x][x] === this[x] ? this.jQ.insertBefore(this.selection.jQ) : this.jQ.insertBefore(this[q].jQ.first()) : this.jQ.appendTo(this.parent.jQ), this.parent.focus()), this.intervalId = setInterval(this.blink, 500), this }, t.hide = function () { return "intervalId" in this && clearInterval(this.intervalId), delete this.intervalId, this.jQ.detach(), this.jQ = O(), this }, t.withDirInsertAt = function (t, e, n, i) { var s = this.parent; this.parent = e, this[t] = n, this[-t] = i, s !== e && s.blur && s.blur() }, t.insDirOf = function (t, e) { return y(t), this.jQ.insDirOf(t, e.jQ), this.withDirInsertAt(t, e.parent, e[t], e), this.parent.jQ.addClass("mq-hasCursor"), this }, t.insLeftOf = function (t) { return this.insDirOf(x, t) }, t.insRightOf = function (t) { return this.insDirOf(q, t) }, t.insAtDirEnd = function (t, e) { return y(t), this.jQ.insAtDirEnd(t, e.jQ), this.withDirInsertAt(t, e, 0, e.ends[t]), e.focus(), this }, t.insAtLeftEnd = function (t) { return this.insAtDirEnd(x, t) }, t.insAtRightEnd = function (t) { return this.insAtDirEnd(q, t) }, t.jumpUpDown = function (t, e) { var n = this; n.upDownCache[t.id] = k.copy(n); t = n.upDownCache[e.id]; t ? t[q] ? n.insLeftOf(t[q]) : n.insAtRightEnd(t.parent) : (t = n.offset().left, e.seek(t, n)) }, t.offset = function () { var t = this.jQ.removeClass("mq-cursor").offset(); return this.jQ.addClass("mq-cursor"), t }, t.unwrapGramp = function () { var e = this.parent.parent, n = e.parent, i = e[q], s = e[x]; if (e.disown().eachChild(function (t) { t.isEmpty() || (t.children().adopt(n, s, i).each(function (t) { t.jQ.insertBefore(e.jQ.first()) }), s = t.ends[q]) }), !this[q]) if (this[x]) this[q] = this[x][q]; else for (; !this[q];) { if (this.parent = this.parent[q], !this.parent) { this[q] = e[q], this.parent = n; break } this[q] = this.parent.ends[x] } this[q] ? this.insLeftOf(this[q]) : this.insAtRightEnd(n), e.jQ.remove(), e[x].siblingDeleted && e[x].siblingDeleted(this.options, q), e[q].siblingDeleted && e[q].siblingDeleted(this.options, x) }, t.startSelection = function () { for (var t = this.anticursor = k.copy(this), e = t.ancestors = {}, n = t; n.parent; n = n.parent)e[n.parent.id] = n }, t.endSelection = function () { delete this.anticursor }, t.select = function () { var t = this.anticursor; if (this[x] === t[x] && this.parent === t.parent) return !1; for (var e = this; e.parent; e = e.parent)if (e.parent.id in t.ancestors) { var n = e.parent; break } c("cursor and anticursor in the same tree", n); var i, s, r = t.ancestors[n.id], o = q; if (e[x] !== r) for (var a = e; a; a = a[q])if (a[q] === r[q]) { o = x, i = e, s = r; break } return o === q && (i = r, s = e), i instanceof k && (i = i[q]), s instanceof k && (s = s[x]), this.hide().selection = n.selectChildren(i, s), this.insDirOf(o, this.selection.ends[o]), this.selectionChanged(), !0 }, t.clearSelection = function () { return this.selection && (this.selection.clear(), delete this.selection, this.selectionChanged()), this }, t.deleteSelection = function () { this.selection && (this[x] = this.selection.ends[x][x], this[q] = this.selection.ends[q][q], this.selection.remove(), this.selectionChanged(), delete this.selection) }, t.replaceSelection = function () { var t = this.selection; return t && (this[x] = t.ends[x][x], this[q] = t.ends[q][q], delete this.selection), t } }), S = g(j, function (t, e) { t.init = function () { e.init.apply(this, arguments), this.jQ = this.jQ.wrapAll('<span class="mq-selection"></span>').parent() }, t.adopt = function () { return this.jQ.replaceWith(this.jQ = this.jQ.children()), e.adopt.apply(this, arguments) }, t.clear = function () { return this.jQ.replaceWith(this.jQ[0].childNodes), this }, t.join = function (n) { return this.fold("", function (t, e) { return t + e[n]() }) } }), L = g(function (t) { t.init = function (t, e, n) { this.id = t.id, this.data = {}, this.root = t, this.container = e, this.options = n, (t.controller = this).cursor = t.cursor = D(t, n) }, t.handle = function (t, e) { var n, i = this.options.handlers; i && i.fns[t] && (n = i.APIClasses[this.KIND_OF_MQ](this), e === x || e === q ? i.fns[t](e, n) : i.fns[t](n)) }; var e = []; this.onNotify = function (t) { e.push(t) }, t.notify = function () { for (var t = 0; t < e.length; t += 1)e[t].apply(this.cursor, arguments); return this } }), E = {}, A = g(), I = {}, R = g(), z = {}; function M() { window.console && console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide') } function B(t) { return M(), $t(t) } B.prototype = R.p, B.interfaceVersion = function (t) { if (1 !== t) throw "Only interface version 1 supported. You specified: " + t; return (M = function () { window.console && console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide') })(), B }; var F = (B.getInterface = t).MIN = 1, $ = t.MAX = 2; function t(r) { if (!(F <= r && r <= $)) throw "Only interface versions between " + F + " and " + $ + " supported. You specified: " + r; function o(t) { if (!t || !t.nodeType) return null; t = O(t).children(".mq-root-block").attr(p), t = t && C.byId[t].controller; return t ? a[t.KIND_OF_MQ](t) : null } var a = {}; function e(t, e) { for (var n in e && e.handlers && (e.handlers = { fns: e.handlers, APIClasses: a }), e) { var i, s; e.hasOwnProperty(n) && (i = e[n], s = I[n], t[n] = s ? s(i) : i) } } o.L = x, o.R = q, o.config = function (t) { return e(A.p, t), this }, o.registerEmbed = function (t, e) { if (!/^[a-z][a-z0-9]*$/i.test(t)) throw "Embed name must start with letter and be only letters and digits"; z[t] = e }; var t, n = a.AbstractMathQuill = g(R, function (t) { t.init = function (t) { this.__controller = t, this.__options = t.options, this.id = t.id, this.data = t.data }, t.__mathquillify = function (t) { var e = this.__controller, n = e.root, i = e.container; e.createTextarea(); var s = i.addClass(t).contents().detach(); n.jQ = O('<span class="mq-root-block"/>').attr(p, n.id).appendTo(i), this.latex(s.text()), this.revert = function () { return i.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(s) } }, t.config = function (t) { return e(this.__options, t), this }, t.el = function () { return this.__controller.container[0] }, t.text = function () { return this.__controller.exportText() }, t.latex = function (t) { return 0 < arguments.length ? (this.__controller.renderLatexMath(t), this.__controller.blurred && this.__controller.cursor.hide().parent.blur(), this) : this.__controller.exportLatex() }, t.html = function () { return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g, "").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i, "").replace(/ mq-hasCursor|mq-hasCursor ?/, "").replace(/ class=(""|(?= |>))/g, "") }, t.reflow = function () { return this.__controller.root.postOrder("reflow"), this } }); for (t in o.prototype = n.prototype, a.EditableField = g(n, function (t, e) { t.__mathquillify = function () { return e.__mathquillify.apply(this, arguments), this.__controller.editable = !0, this.__controller.delegateMouseEvents(), this.__controller.editablesTextareaEvents(), this }, t.focus = function () { return this.__controller.textarea.focus(), this }, t.blur = function () { return this.__controller.textarea.blur(), this }, t.write = function (t) { return this.__controller.writeLatex(t), this.__controller.scrollHoriz(), this.__controller.blurred && this.__controller.cursor.hide().parent.blur(), this }, t.cmd = function (t) { var e, n = this.__controller.notify(), i = n.cursor; return /^\\[a-z]+$/i.test(t) ? (t = t.slice(1), (e = Q[t]) && (t = e(t), i.selection && t.replaces(i.replaceSelection()), t.createLeftOf(i.show()), this.__controller.scrollHoriz())) : i.parent.write(i, t), n.blurred && i.hide().parent.blur(), this }, t.select = function () { var t = this.__controller; for (t.notify("move").cursor.insAtRightEnd(t.root); t.cursor[x];)t.selectLeft(); return this }, t.clearSelection = function () { return this.__controller.cursor.clearSelection(), this }, t.moveToDirEnd = function (t) { return this.__controller.notify("move").cursor.insAtDirEnd(t, this.__controller.root), this }, t.moveToLeftEnd = function () { return this.moveToDirEnd(x) }, t.moveToRightEnd = function () { return this.moveToDirEnd(q) }, t.keystroke = function (t) { for (var t = t.replace(/^\s+|\s+$/g, "").split(/\s+/), e = 0; e < t.length; e += 1)this.__controller.keystroke(t[e], { preventDefault: m }); return this }, t.typedText = function (t) { for (var e = 0; e < t.length; e += 1)this.__controller.typedText(t.charAt(e)); return this }, t.dropEmbedded = function (t, e, n) { var i = t - O(window).scrollLeft(), s = e - O(window).scrollTop(), s = document.elementFromPoint(i, s); this.__controller.seek(O(s), t, e), Ft().setOptions(n).createLeftOf(this.__controller.cursor) } }), (o.EditableField = function () { throw "wtf don't call me, I'm 'abstract'" }).prototype = a.EditableField.prototype, E) !function (i, t) { var s = a[i] = t(a); (o[i] = function (t, e) { var n = o(t); if (n instanceof s || !t || !t.nodeType) return n; t = L(s.RootBlock(), O(t), A()); return t.KIND_OF_MQ = i, s(t).__mathquillify(e, r) }).prototype = s.prototype }(t, E[t]); return o } B.noConflict = function () { return window.MathQuill = N, B }; var N = window.MathQuill; function P(t) { for (var e = "moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" "), n = 0; n < e.length; n += 1)!function (e) { t[e] = function (t) { this.controller.handle(e, t) } }(e[n]); t.reflow = function () { this.controller.handle("reflow"), this.controller.handle("edited"), this.controller.handle("edit") } } window.MathQuill = B; var W, U = g(function (t, e, a) { function n(t, e) { throw "Parse Error: " + e + " at " + (t = t ? "'" + t + "'" : "EOF") } t.init = function (t) { this._ = t }, t.parse = function (t) { return this.skip(s)._("" + t, function (t, e) { return e }, n) }, t.or = function (s) { c("or is passed a parser", s instanceof a); var t = this; return a(function (e, n, i) { return t._(e, n, function (t) { return s._(e, n, i) }) }) }, t.then = function (s) { var e = this; return a(function (t, n, i) { return e._(t, function (t, e) { e = s instanceof a ? s : s(e); return c("a parser is returned", e instanceof a), e._(t, n, i) }, i) }) }, t.many = function () { var o = this; return a(function (n, t, e) { for (var i = []; o._(n, s, r);); return t(n, i); function s(t, e) { return n = t, i.push(e), !0 } function r() { return !1 } }) }, t.times = function (h, u) { arguments.length < 2 && (u = h); var f = this; return a(function (n, t, e) { for (var i, s = [], r = !0, o = 0; o < h; o += 1)if (!(r = f._(n, a, l))) return e(n, i); for (; o < u && r; o += 1)r = f._(n, a, c); return t(n, s); function a(t, e) { return s.push(e), n = t, !0 } function l(t, e) { return i = e, n = t, !1 } function c(t, e) { return !1 } }) }, t.result = function (t) { return this.then(i(t)) }, t.atMost = function (t) { return this.times(0, t) }, t.atLeast = function (t) { var n = this; return n.times(t).then(function (e) { return n.many().map(function (t) { return e.concat(t) }) }) }, t.map = function (e) { return this.then(function (t) { return i(e(t)) }) }, t.skip = function (e) { return this.then(function (t) { return e.result(t) }) }; this.string = function (s) { var r = s.length, o = "expected '" + s + "'"; return a(function (t, e, n) { var i = t.slice(0, r); return i === s ? e(t.slice(r), i) : n(t, o) }) }; var t = this.regex = function (s) { c("regexp parser is anchored", "^" === s.toString().charAt(1)); var r = "expected " + s; return a(function (t, e, n) { var i = s.exec(t); if (i) { i = i[0]; return e(t.slice(i.length), i) } return n(t, r) }) }, i = a.succeed = function (n) { return a(function (t, e) { return e(t, n) }) }, s = (a.fail = function (i) { return a(function (t, e, n) { return n(t, i) }) }, a.letter = t(/^[a-z]/i), a.letters = t(/^[a-z]*/i), a.digit = t(/^[0-9]/), a.digits = t(/^[0-9]*/), a.whitespace = t(/^\s+/), a.optWhitespace = t(/^\s*/), a.any = a(function (t, e, n) { return t ? e(t.slice(1), t.charAt(0)) : n(t, "expected any character") }), a.all = a(function (t, e, n) { return e("", t) }), a.eof = a(function (t, e, n) { return t ? n(t, "expected EOF") : e(t, t) })) }), H = (W = { 8: "Backspace", 9: "Tab", 10: "Enter", 13: "Enter", 16: "Shift", 17: "Control", 18: "Alt", 20: "CapsLock", 27: "Esc", 32: "Spacebar", 33: "PageUp", 34: "PageDown", 35: "End", 36: "Home", 37: "Left", 38: "Up", 39: "Right", 40: "Down", 45: "Insert", 46: "Del", 144: "NumLock" }, function (t, s) { var e, r = null, n = null, i = f(t), t = f(s.container || i), o = m; function a(t) { o = t, clearTimeout(e), e = setTimeout(t) } t.bind("keydown keypress input keyup focusout paste", function (t) { o(t) }); var l = !1; function c() { var t, e, n, i; s.keystroke((e = (t = r).which || t.keyCode, n = W[e], i = [], t.ctrlKey && i.push("Ctrl"), t.originalEvent && t.originalEvent.metaKey && i.push("Meta"), t.altKey && i.push("Alt"), t.shiftKey && i.push("Shift"), e = n || String.fromCharCode(e), i.length || n ? (i.push(e), i.join("-")) : e), r) } function h() { var t; "selectionStart" in (t = i[0]) && t.selectionStart !== t.selectionEnd || (1 === (t = i.val()).length ? (i.val(""), s.typedText(t)) : t && i[0].select && i[0].select()) } function u() { var t = i.val(); i.val(""), t && s.paste(t) } return t.bind({ keydown: function (t) { r = t, n = null, l && a(function (t) { t && "focusout" === t.type || !i[0].select || i[0].select(), o = m, clearTimeout(e) }), c() }, keypress: function (t) { r && n && c(), n = t, a(h) }, focusout: function () { r = n = null }, paste: function (t) { i.focus(), a(u) } }), { select: function (t) { o(), o = m, clearTimeout(e), i.val(t), t && i[0].select && i[0].select(), l = !!t } } }); L.open(function (t, e) { t.exportText = function () { return this.root.foldChildren("", function (t, e) { return t + e.text() }) } }), L.open(function (t) { t.focusBlurEvents = function () { var t, e = this, n = e.root, i = e.cursor; function s() { clearTimeout(t), i.selection && i.selection.jQ.addClass("mq-blur"), r() } function r() { i.hide().parent.blur(), e.container.removeClass("mq-focused"), O(window).off("blur", s) } e.textarea.focus(function () { e.blurred = !1, clearTimeout(t), e.container.addClass("mq-focused"), i.parent || i.insAtRightEnd(n), i.selection ? (i.selection.jQ.removeClass("mq-blur"), e.selectionChanged()) : i.show() }).blur(function () { e.blurred = !0, t = setTimeout(function () { n.postOrder("intentionalBlur"), i.clearSelection().endSelection(), r() }), O(window).on("blur", s) }), e.blurred = !0, i.hide().parent.blur() } }), L.open(function (t) { t.keystroke = function (t, e) { this.cursor.parent.keystroke(t, e, this) } }), C.open(function (t) { t.keystroke = function (t, e, n) { var i = n.cursor; switch (t) { case "Ctrl-Shift-Backspace": case "Ctrl-Backspace": n.ctrlDeleteDir(x); break; case "Shift-Backspace": case "Backspace": n.backspace(); break; case "Esc": case "Tab": return void n.escapeDir(q, t, e); case "Shift-Tab": case "Shift-Esc": return void n.escapeDir(x, t, e); case "End": n.notify("move").cursor.insAtRightEnd(i.parent); break; case "Ctrl-End": n.notify("move").cursor.insAtRightEnd(n.root); break; case "Shift-End": for (; i[q];)n.selectRight(); break; case "Ctrl-Shift-End": for (; i[q] || i.parent !== n.root;)n.selectRight(); break; case "Home": n.notify("move").cursor.insAtLeftEnd(i.parent); break; case "Ctrl-Home": n.notify("move").cursor.insAtLeftEnd(n.root); break; case "Shift-Home": for (; i[x];)n.selectLeft(); break; case "Ctrl-Shift-Home": for (; i[x] || i.parent !== n.root;)n.selectLeft(); break; case "Left": n.moveLeft(); break; case "Shift-Left": n.selectLeft(); break; case "Ctrl-Left": break; case "Right": n.moveRight(); break; case "Shift-Right": n.selectRight(); break; case "Ctrl-Right": break; case "Up": n.moveUp(); break; case "Down": n.moveDown(); break; case "Shift-Up": if (i[x]) for (; i[x];)n.selectLeft(); else n.selectLeft(); case "Shift-Down": if (i[q]) for (; i[q];)n.selectRight(); else n.selectRight(); case "Ctrl-Up": case "Ctrl-Down": break; case "Ctrl-Shift-Del": case "Ctrl-Del": n.ctrlDeleteDir(q); break; case "Shift-Del": case "Del": n.deleteForward(); break; case "Meta-A": case "Ctrl-A": for (n.notify("move").cursor.insAtRightEnd(n.root); i[x];)n.selectLeft(); break; default: return }e.preventDefault(), n.scrollHoriz() }, t.moveOutOf = t.moveTowards = t.deleteOutOf = t.deleteTowards = t.unselectInto = t.selectOutOf = t.selectTowards = function () { c("overridden or never called on this node") } }), L.open(function (t) { function e(t, e) { var n = t.notify("upDown").cursor, i = e + "Into", s = e + "OutOf"; return n[q][i] ? n.insAtLeftEnd(n[q][i]) : n[x][i] ? n.insAtRightEnd(n[x][i]) : n.parent.bubble(function (t) { var e = t[s]; if (e && ("function" == typeof e && (e = t[s](n)), e instanceof C && n.jumpUpDown(t, e), !0 !== e)) return !1 }), t } this.onNotify(function (t) { "move" !== t && "upDown" !== t || this.show().clearSelection() }), t.escapeDir = function (t, e, n) { y(t); var i = this.cursor; if (i.parent !== this.root && n.preventDefault(), i.parent !== this.root) return i.parent.moveOutOf(t, i), this.notify("move") }, I.leftRightIntoCmdGoes = function (t) { if (t && "up" !== t && "down" !== t) throw '"up" or "down" required for leftRightIntoCmdGoes option, got "' + t + '"'; return t }, t.moveDir = function (t) { y(t); var e = this.cursor, n = e.options.leftRightIntoCmdGoes; return e.selection ? e.insDirOf(t, e.selection.ends[t]) : e[t] ? e[t].moveTowards(t, e, n) : e.parent.moveOutOf(t, e, n), this.notify("move") }, t.moveLeft = function () { return this.moveDir(x) }, t.moveRight = function () { return this.moveDir(q) }, t.moveUp = function () { return e(this, "up") }, t.moveDown = function () { return e(this, "down") }, this.onNotify(function (t) { "upDown" !== t && (this.upDownCache = {}) }), this.onNotify(function (t) { "edit" === t && this.show().deleteSelection() }), t.deleteDir = function (t) { y(t); var e = this.cursor, n = e.selection; return this.notify("edit"), n || (e[t] ? e[t].deleteTowards(t, e) : e.parent.deleteOutOf(t, e)), e[x].siblingDeleted && e[x].siblingDeleted(e.options, q), e[q].siblingDeleted && e[q].siblingDeleted(e.options, x), e.parent.bubble("reflow"), this }, t.ctrlDeleteDir = function (t) { y(t); t = this.cursor; return !t[x] || t.selection ? ctrlr.deleteDir() : (this.notify("edit"), j(t.parent.ends[x], t[x]).remove(), t.insAtDirEnd(x, t.parent), t[x].siblingDeleted && t[x].siblingDeleted(t.options, q), t[q].siblingDeleted && t[q].siblingDeleted(t.options, x), t.parent.bubble("reflow"), this) }, t.backspace = function () { return this.deleteDir(x) }, t.deleteForward = function () { return this.deleteDir(q) }, this.onNotify(function (t) { "select" !== t && this.endSelection() }), t.selectDir = function (t) { var e = this.notify("select").cursor, n = e.selection; y(t), e.anticursor || e.startSelection(); var i = e[t]; i ? n && n.ends[t] === i && e.anticursor[-t] !== i ? i.unselectInto(t, e) : i.selectTowards(t, e) : e.parent.selectOutOf(t, e), e.clearSelection(), e.select() || e.show() }, t.selectLeft = function () { return this.selectDir(x) }, t.selectRight = function () { return this.selectDir(q) } }); var G, K, Y, Z, X, V, J = (yt = U.string, G = U.regex, K = U.letter, Y = U.any, qt = U.optWhitespace, Z = U.succeed, X = U.fail, et = K.map(function (t) { return mt(t) }), K = G(/^[^${}\\_^]/).map(function (t) { return st(t) }), et = G(/^[^\\a-eg-zA-Z]/).or(yt("\\").then(G(/^[a-z]+/i).or(G(/^\s+/).result(" ")).or(Y))).then(function (t) { var e = Q[t]; return e ? e(t).parser() : X("unknown command: \\" + t) }).or(et).or(K), K = yt("{").then(function () { return V }).skip(yt("}")), et = qt.then(K.or(et.map(function (t) { var e = ot(); return t.adopt(e, 0, 0), e }))), V = et.many().map(tt).skip(qt), qt = yt("[").then(et.then(function (t) { return "]" !== t.join("latex") ? Z(t) : X() }).many().map(tt).skip(qt)).skip(yt("]")), (yt = V).block = et, yt.optBlock = qt, yt); function tt(t) { for (var e = t[0] || ot(), n = 1; n < t.length; n += 1)t[n].children().adopt(e, e.ends[q], 0); return e } L.open(function (t, e) { t.exportLatex = function () { return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi, "$1") }, t.writeLatex = function (t) { var e = this.notify("edit").cursor, n = U.all, i = U.eof, t = J.skip(i).or(n.result(!1)).parse(t); return t && !t.isEmpty() && (t.children().adopt(e.parent, e[x], e[q]), t.jQize().insertBefore(e.jQ), e[x] = t.ends[q], t.finalizeInsert(e.options, e), t.ends[q][q].siblingCreated && t.ends[q][q].siblingCreated(e.options, x), t.ends[x][x].siblingCreated && t.ends[x][x].siblingCreated(e.options, q), e.parent.bubble("reflow")), this }, t.renderLatexMath = function (t) { var e = this.root, n = this.cursor, i = U.all, s = U.eof, i = J.skip(s).or(i.result(!1)).parse(t); e.eachChild("postOrder", "dispose"), e.ends[x] = e.ends[q] = 0, i && i.children().adopt(e, 0, 0); t = e.jQ; i ? (i = i.join("html"), t.html(i), e.jQize(t.children()), e.finalizeInsert(n.options)) : t.empty(), delete n.selection, n.insAtRightEnd(e) }, t.renderLatexText = function (t) { var e = this.root, i = this.cursor; e.jQ.children().slice(1).remove(), e.eachChild("postOrder", "dispose"), e.ends[x] = e.ends[q] = 0, delete i.selection, i.show().insAtRightEnd(e); var n = U.regex, s = U.string, r = U.eof, o = U.all, a = s("$").then(J).skip(s("$").or(r)).map(function (t) { var e = ut(i); e.createBlocks(); var n = e.ends[x]; return t.children().adopt(n, 0, 0), e }), n = s("\\$").result("$").or(n(/^[^$]/)).map(st), l = a.or(n).many().skip(r).or(o.result(!1)).parse(t); if (l) { for (var c = 0; c < l.length; c += 1)l[c].adopt(e, e.ends[q], 0); e.jQize().appendTo(e.jQ), e.finalizeInsert(i.options) } } }), L.open(function (t) { t.delegateMouseEvents = function () { var h = this.root.jQ; this.container.bind("mousedown.mathquill", function (t) { var e, n = O(t.target).closest(".mq-root-block"), i = C.byId[n.attr(p) || h.attr(p)].controller, s = i.cursor, r = s.blink, o = i.textareaSpan, a = i.textarea; function l(t) { e = O(t.target) } function c(t) { s.anticursor || s.startSelection(), i.seek(e, t.pageX, t.pageY).cursor.select(), e = u } i.blurred && (i.editable || n.prepend(o), a.focus()), t.preventDefault(), t.target.unselectable = !0, s.blink = m, i.seek(O(t.target), t.pageX, t.pageY).cursor.startSelection(), n.mousemove(l), O(t.target.ownerDocument).mousemove(c).mouseup(function t(e) { s.blink = r, s.selection || (i.editable ? s.show() : o.detach()), n.unbind("mousemove", l), O(e.target.ownerDocument).unbind("mousemove", c).unbind("mouseup", t) }) }) } }), L.open(function (t) { t.seek = function (t, e, n) { var i = this.notify("select").cursor; t && ((s = t.attr(p) || t.attr(r)) || (s = (t = t.parent()).attr(p) || t.attr(r))); var s = s ? C.byId[s] : this.root; return c("nodeId is the id of some Node that exists", s), i.clearSelection().show(), s.seek(e, i), this.scrollHoriz(), this } }), L.open(function (t) { t.scrollHoriz = function () { var t = this.cursor, e = t.selection, n = this.root.jQ[0].getBoundingClientRect(); if (e) { var i = e.jQ[0].getBoundingClientRect(), s = i.left - (n.left + 20), r = i.right - (n.right - 20); if (e.ends[x] === t[q]) if (s < 0) var o = s; else { if (!(0 < r)) return; o = i.left - r < n.left + 20 ? s : r } else if (0 < r) o = r; else { if (!(s < 0)) return; o = i.right - s > n.right - 20 ? r : s } } else { t = t.jQ[0].getBoundingClientRect().left; if (t > n.right - 20) var o = t - (n.right - 20); else { if (!(t < n.left + 20)) return; var o = t - (n.left + 20) } } this.root.jQ.stop().animate({ scrollLeft: "+=" + o }, 100) } }), L.open(function (t) { A.p.substituteTextarea = function () { return O("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0] }, t.createTextarea = function () { var t = this.textareaSpan = O('<span class="mq-textarea"></span>'), e = this.options.substituteTextarea(); if (!e.nodeType) throw "substituteTextarea() must return a DOM element, got " + e; e = this.textarea = O(e).appendTo(t); var n = this; n.cursor.selectionChanged = function () { n.selectionChanged() }, n.container.bind("copy", function () { n.setTextareaSelection() }) }, t.selectionChanged = function () { var t = this; Qt(t.container[0]), t.textareaSelectionTimeout === u && (t.textareaSelectionTimeout = setTimeout(function () { t.setTextareaSelection() })) }, t.setTextareaSelection = function () { this.textareaSelectionTimeout = u; var t = ""; this.cursor.selection && (t = this.cursor.selection.join("latex"), this.options.statelessClipboard && (t = "$" + t + "$")), this.selectFn(t) }, t.staticMathTextareaEvents = function () { var t = this, e = (t.root, t.cursor), n = t.textarea, i = t.textareaSpan; function s() { i.detach(), t.blurred = !0 } this.container.prepend('<span class="mq-selectable">$' + t.exportLatex() + "$</span>"), t.blurred = !0, n.bind("cut paste", !1).focus(function () { t.blurred = !1 }).blur(function () { e.selection && e.selection.clear(), setTimeout(s) }), t.selectFn = function (t) { n.val(t), t && n.select() } }, t.editablesTextareaEvents = function () { var e = this, n = (e.root, e.cursor), t = e.textarea, i = e.textareaSpan, s = H(t, this); this.selectFn = function (t) { s.select(t) }, this.container.prepend(i).on("cut", function (t) { n.selection && setTimeout(function () { e.notify("edit"), n.parent.bubble("reflow") }) }), this.focusBlurEvents() }, t.typedText = function (t) { if ("\n" === t) return this.handle("enter"); var e = this.notify().cursor; e.parent.write(e, t), this.scrollHoriz() }, t.paste = function (t) { this.options.statelessClipboard && (t = "$" === t.slice(0, 1) && "$" === t.slice(-1) ? t.slice(1, -1) : "\\text{" + t + "}"), this.writeLatex(t).cursor.show() } }); var et = g(C, function (t, e) { t.finalizeInsert = function (t, e) { var n = this; n.postOrder("finalizeTree", t), n.postOrder("contactWeld", e), n.postOrder("blur"), n.postOrder("reflow"), n[q].siblingCreated && n[q].siblingCreated(t, x), n[x].siblingCreated && n[x].siblingCreated(t, q), n.bubble("reflow") } }), nt = g(et, function (t, s) { t.init = function (t, e, n) { var i = this; s.init.call(i), i.ctrlSeq || (i.ctrlSeq = t), e && (i.htmlTemplate = e), n && (i.textTemplate = n) }, t.replaces = function (t) { t.disown(), this.replacedFragment = t }, t.isEmpty = function () { return this.foldChildren(!0, function (t, e) { return t && e.isEmpty() }) }, t.parser = function () { var t = J.block, n = this; return t.times(n.numBlocks()).map(function (t) { n.blocks = t; for (var e = 0; e < t.length; e += 1)t[e].adopt(n, n.ends[q], 0); return n }) }, t.createLeftOf = function (t) { var e = this, n = e.replacedFragment; e.createBlocks(), s.createLeftOf.call(e, t), n && (n.adopt(e.ends[x], 0, 0), n.jQ.appendTo(e.ends[x].jQ)), e.finalizeInsert(t.options), e.placeCursor(t) }, t.createBlocks = function () { for (var t = this.numBlocks(), e = this.blocks = Array(t), n = 0; n < t; n += 1)(e[n] = ot()).adopt(this, this.ends[q], 0) }, t.placeCursor = function (t) { t.insAtRightEnd(this.foldChildren(this.ends[x], function (t, e) { return t.isEmpty() ? t : e })) }, t.moveTowards = function (t, e, n) { n = n && this[n + "Into"]; e.insAtDirEnd(-t, n || this.ends[-t]) }, t.deleteTowards = function (t, e) { this.isEmpty() ? e[t] = this.remove()[t] : this.moveTowards(t, e, null) }, t.selectTowards = function (t, e) { e[-t] = this, e[t] = this[t] }, t.selectChildren = function () { return S(this, this) }, t.unselectInto = function (t, e) { e.insAtDirEnd(-t, e.anticursor.ancestors[this.id]) }, t.seek = function (n, i) { function s(t) { var e = {}; return e[x] = t.jQ.offset().left, e[q] = e[x] + t.jQ.outerWidth(), e } var r = this, o = s(r); if (n < o[x]) return i.insLeftOf(r); if (n > o[q]) return i.insRightOf(r); var a = o[x]; r.eachChild(function (t) { var e = s(t); return n < e[x] ? (n - a < e[x] - n ? t[x] ? i.insAtRightEnd(t[x]) : i.insLeftOf(r) : i.insAtLeftEnd(t), !1) : n > e[q] ? void (t[q] ? a = e[q] : o[q] - n < n - e[q] ? i.insRightOf(r) : i.insAtRightEnd(t)) : (t.seek(n, i), !1) }) }, t.numBlocks = function () { var t = this.htmlTemplate.match(/&\d+/g); return t ? t.length : 0 }, t.html = function () { var n = this.blocks, t = " mathquill-command-id=" + this.id, e = this.htmlTemplate.match(/<[^<>]+>|[^<>]+/g); c("no unmatched angle brackets", e.join("") === this.htmlTemplate); for (var i = 0, s = e[0]; s; s = e[i += 1])if ("/>" === s.slice(-2)) e[i] = s.slice(0, -2) + t + "/>"; else if ("<" === s.charAt(0)) { c("not an unmatched top-level close tag", "/" !== s.charAt(1)), e[i] = s.slice(0, -1) + t + ">"; for (var r = 1; c("no missing close tags", s = e[i += 1]), "</" === s.slice(0, 2) ? --r : "<" === s.charAt(0) && "/>" !== s.slice(-2) && (r += 1), 0 < r;); } return e.join("").replace(/>&(\d+)/g, function (t, e) { return " mathquill-block-id=" + n[e].id + ">" + n[e].join("html") }) }, t.latex = function () { return this.foldChildren(this.ctrlSeq, function (t, e) { return t + "{" + (e.latex() || " ") + "}" }) }, t.textTemplate = [""], t.text = function () { var i = this, s = 0; return i.foldChildren(i.textTemplate[s], function (t, e) { s += 1; var n = e.text(); return t && "(" === i.textTemplate[s] && "(" === n[0] && ")" === n.slice(-1) ? t + n.slice(1, -1) + i.textTemplate[s] : t + e.text() + (i.textTemplate[s] || "") }) } }), it = g(nt, function (t, i) { t.init = function (t, e, n) { n = n || (t && 1 < t.length ? t.slice(1) : t), i.init.call(this, t, e, [n]) }, t.parser = function () { return U.succeed(this) }, t.numBlocks = function () { return 0 }, t.replaces = function (t) { t.remove() }, t.createBlocks = m, t.moveTowards = function (t, e) { e.jQ.insDirOf(t, this.jQ), e[-t] = this, e[t] = this[t] }, t.deleteTowards = function (t, e) { e[t] = this.remove()[t] }, t.seek = function (t, e) { t - this.jQ.offset().left < this.jQ.outerWidth() / 2 ? e.insLeftOf(this) : e.insRightOf(this) }, t.latex = function () { return this.ctrlSeq }, t.text = function () { return this.textTemplate }, t.placeCursor = m, t.isEmpty = function () { return !0 } }), st = g(it, function (t, n) { t.init = function (t, e) { n.init.call(this, t, "<span>" + (e || t) + "</span>") } }), rt = g(it, function (t, i) { t.init = function (t, e, n) { i.init.call(this, t, '<span class="mq-binary-operator">' + e + "</span>", n) } }), ot = g(et, function (t, i) { t.join = function (n) { return this.foldChildren("", function (t, e) { return t + e[n]() }) }, t.html = function () { return this.join("html") }, t.latex = function () { return this.join("latex") }, t.text = function () { return this.ends[x] === this.ends[q] && 0 !== this.ends[x] ? this.ends[x].text() : this.join("text") }, t.keystroke = function (t, e, n) { return !n.options.spaceBehavesLikeTab || "Spacebar" !== t && "Shift-Spacebar" !== t ? i.keystroke.apply(this, arguments) : (e.preventDefault(), void n.escapeDir("Shift-Spacebar" === t ? x : q, t, e)) }, t.moveOutOf = function (t, e, n) { !(n && this.parent[n + "Into"]) && this[t] ? e.insAtDirEnd(-t, this[t]) : e.insDirOf(t, this.parent) }, t.selectOutOf = function (t, e) { e.insDirOf(t, this.parent) }, t.deleteOutOf = function (t, e) { e.unwrapGramp() }, t.seek = function (t, e) { var n = this.ends[q]; if (!n || n.jQ.offset().left + n.jQ.outerWidth() < t) return e.insAtRightEnd(this); if (t < this.ends[x].jQ.offset().left) return e.insAtLeftEnd(this); for (; t < n.jQ.offset().left;)n = n[x]; return n.seek(t, e) }, t.chToCmd = function (t) { var e; return (t.match(/^[a-eg-zA-Z]$/) ? mt : /^\d$/.test(t) ? pt : (e = _[t] || Q[t]) ? e : st)(t) }, t.write = function (t, e) { e = this.chToCmd(e); t.selection && e.replaces(t.replaceSelection()), e.createLeftOf(t.show()) }, t.focus = function () { return this.jQ.addClass("mq-hasCursor"), this.jQ.removeClass("mq-empty"), this }, t.blur = function () { return this.jQ.removeClass("mq-hasCursor"), this.isEmpty() && this.jQ.addClass("mq-empty"), this } }); E.StaticMath = function (n) { return g(n.AbstractMathQuill, function (t, e) { this.RootBlock = ot, t.__mathquillify = function () { return e.__mathquillify.call(this, "mq-math-mode"), this.__controller.delegateMouseEvents(), this.__controller.staticMathTextareaEvents(), this }, t.init = function () { e.init.apply(this, arguments), this.__controller.root.postOrder("registerInnerField", this.innerFields = [], n.MathField) }, t.latex = function () { var t = e.latex.apply(this, arguments); return 0 < arguments.length && this.__controller.root.postOrder("registerInnerField", this.innerFields = [], n.MathField), t } }) }; var at = g(ot, P); E.MathField = function (t) { return g(t.EditableField, function (t, n) { this.RootBlock = at, t.__mathquillify = function (t, e) { return this.config(t), 1 < e && (this.__controller.root.reflow = m), n.__mathquillify.call(this, "mq-editable-field mq-math-mode"), delete this.__controller.root.reflow, this } }) }; var lt = g(C, function (t, i) { function l(t) { t.jQ[0].normalize(); var e = t.jQ[0].firstChild; c("only node in TextBlock span is Text node", 3 === e.nodeType); var n = ct(e.data); return n.jQadd(e), t.children().disown(), n.adopt(t, 0, 0) } t.ctrlSeq = "\\text", t.replaces = function (t) { t instanceof j ? this.replacedText = t.remove().jQ.text() : "string" == typeof t && (this.replacedText = t) }, t.jQadd = function (t) { i.jQadd.call(this, t), this.ends[x] && this.ends[x].jQadd(this.jQ[0].firstChild) }, t.createLeftOf = function (t) { var e = this; if (i.createLeftOf.call(this, t), e[q].siblingCreated && e[q].siblingCreated(t.options, x), e[x].siblingCreated && e[x].siblingCreated(t.options, q), e.bubble("reflow"), t.insAtRightEnd(e), e.replacedText) for (var n = 0; n < e.replacedText.length; n += 1)e.write(t, e.replacedText.charAt(n)) }, t.parser = function () { var e = this, t = U.string, n = U.regex; return U.optWhitespace.then(t("{")).then(n(/^[^}]*/)).skip(t("}")).map(function (t) { return ct(t).adopt(e, 0, 0), e }) }, t.textContents = function () { return this.foldChildren("", function (t, e) { return t + e.text }) }, t.text = function () { return '"' + this.textContents() + '"' }, t.latex = function () { return "\\text{" + this.textContents() + "}" }, t.html = function () { return '<span class="mq-text-mode" mathquill-command-id=' + this.id + ">" + this.textContents() + "</span>" }, t.moveTowards = function (t, e) { e.insAtDirEnd(-t, this) }, t.moveOutOf = function (t, e) { e.insDirOf(t, this) }, t.unselectInto = t.moveTowards, t.selectTowards = nt.prototype.selectTowards, t.deleteTowards = nt.prototype.deleteTowards, t.selectOutOf = function (t, e) { e.insDirOf(t, this) }, t.deleteOutOf = function (t, e) { this.isEmpty() && e.insRightOf(this) }, t.write = function (t, e) { var n; t.show().deleteSelection(), "$" !== e ? t[x] ? t[x].appendText(e) : ct(e).createLeftOf(t) : this.isEmpty() ? (t.insRightOf(this), st("\\$", "$").createLeftOf(t)) : t[q] ? t[x] ? (n = lt(), (e = this.ends[x]).disown(), e.adopt(n, 0, 0), t.insLeftOf(this), i.createLeftOf.call(n, t)) : t.insLeftOf(this) : t.insRightOf(this) }, t.seek = function (t, e) { e.hide(); var n = l(this), i = this.jQ.width() / this.text.length, i = Math.round((t - this.jQ.offset().left) / i); i <= 0 ? e.insAtLeftEnd(this) : i >= n.text.length ? e.insAtRightEnd(this) : e.insLeftOf(n.splitRight(i)); for (var s, r = t - e.show().offset().left, o = r && r < 0 ? x : q, a = o; e[o] && 0 < r * a;)e[o].moveTowards(o, e), a = r, r = t - e.offset().left; o * r < -o * a && e[-o].moveTowards(-o, e), e.anticursor ? e.anticursor.parent === this && (i = e[x] && e[x].text.length, this.anticursorPosition === i ? e.anticursor = k.copy(e) : (this.anticursorPosition < i ? (s = e[x].splitRight(this.anticursorPosition), e[x] = s) : s = e[q].splitRight(this.anticursorPosition - i), e.anticursor = k(this, s[x], s))) : this.anticursorPosition = e[x] && e[x].text.length }, t.blur = function () { ot.prototype.blur.call(this), l(this) }, t.focus = ot.prototype.focus }), ct = g(C, function (t, e) { function o(t, e) { return e.charAt(t === x ? 0 : -1 + e.length) } t.init = function (t) { e.init.call(this), this.text = t }, t.jQadd = function (t) { this.dom = t, this.jQ = O(t) }, t.jQize = function () { return this.jQadd(document.createTextNode(this.text)) }, t.appendText = function (t) { this.text += t, this.dom.appendData(t) }, t.prependText = function (t) { this.text = t + this.text, this.dom.insertData(0, t) }, t.insTextAtDirEnd = function (t, e) { y(e), e === q ? this.appendText(t) : this.prependText(t) }, t.splitRight = function (t) { var e = ct(this.text.slice(t)).adopt(this.parent, this, this[q]); return e.jQadd(this.dom.splitText(t)), this.text = this.text.slice(0, t), e }, t.moveTowards = function (t, e) { y(t); var n = o(-t, this.text), i = this[-t]; return i ? i.insTextAtDirEnd(n, t) : ct(n).createDir(-t, e), this.deleteTowards(t, e) }, t.latex = function () { return this.text }, t.deleteTowards = function (t, e) { 1 < this.text.length ? t === q ? (this.dom.deleteData(0, 1), this.text = this.text.slice(1)) : (this.dom.deleteData(-1 + this.text.length, 1), this.text = this.text.slice(0, -1)) : (this.remove(), this.jQ.remove(), e[t] = this[t]) }, t.selectTowards = function (t, e) { y(t); var n, i, s = e.anticursor, r = o(-t, this.text); return s[t] === this ? (i = ct(r).createDir(t, e), s[t] = i, e.insDirOf(t, i)) : ((n = this[-t]) ? n.insTextAtDirEnd(r, t) : (i = ct(r).createDir(-t, e)).jQ.insDirOf(-t, e.selection.jQ), 1 === this.text.length && s[-t] === this && (s[-t] = this[-t])), this.deleteTowards(t, e) } }); function ht(t, e, n) { return g(lt, { ctrlSeq: t, htmlTemplate: "<" + e + " " + n + ">&0</" + e + ">" }) } _.$ = Q.text = Q.textnormal = Q.textrm = Q.textup = Q.textmd = lt, Q.em = Q.italic = Q.italics = Q.emph = Q.textit = Q.textsl = ht("\\textit", "i", 'class="mq-text-mode"'), Q.strong = Q.bold = Q.textbf = ht("\\textbf", "b", 'class="mq-text-mode"'), Q.sf = Q.textsf = ht("\\textsf", "span", 'class="mq-sans-serif mq-text-mode"'), Q.tt = Q.texttt = ht("\\texttt", "span", 'class="mq-monospace mq-text-mode"'), Q.textsc = ht("\\textsc", "span", 'style="font-variant:small-caps" class="mq-text-mode"'), Q.uppercase = ht("\\uppercase", "span", 'style="text-transform:uppercase" class="mq-text-mode"'), Q.lowercase = ht("\\lowercase", "span", 'style="text-transform:lowercase" class="mq-text-mode"'); var ut = g(nt, function (t, e) { t.init = function (t) { e.init.call(this, "$"), this.cursor = t }, t.htmlTemplate = '<span class="mq-math-mode">&0</span>', t.createBlocks = function () { e.createBlocks.call(this), this.ends[x].cursor = this.cursor, this.ends[x].write = function (t, e) { "$" !== e ? ot.prototype.write.call(this, t, e) : this.isEmpty() ? (t.insRightOf(this.parent), this.parent.deleteTowards(dir, t), st("\\$", "$").createLeftOf(t.show())) : t[q] ? t[x] ? ot.prototype.write.call(this, t, e) : t.insLeftOf(this.parent) : t.insRightOf(this.parent) } }, t.latex = function () { return "$" + this.ends[x].latex() + "$" } }), ft = g(at, function (t, e) { t.keystroke = function (t) { if ("Spacebar" !== t && "Shift-Spacebar" !== t) return e.keystroke.apply(this, arguments) }, t.write = function (t, e) { var n; t.show().deleteSelection(), "$" === e ? ut(t).createLeftOf(t) : ("<" === e ? n = "&lt;" : ">" === e && (n = "&gt;"), st(e, n).createLeftOf(t)) } }); E.TextField = function (t) { return g(t.EditableField, function (t, e) { this.RootBlock = ft, t.__mathquillify = function () { return e.__mathquillify.call(this, "mq-editable-field mq-text-mode") }, t.latex = function (t) { return 0 < arguments.length ? (this.__controller.renderLatexText(t), this.__controller.blurred && this.__controller.cursor.hide().parent.blur(), this) : this.__controller.exportLatex() } }) }, _["\\"] = g(nt, function (t, i) { t.ctrlSeq = "\\", t.replaces = function (t) { this._replacedFragment = t.disown(), this.isEmpty = function () { return !1 } }, t.htmlTemplate = '<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>', t.textTemplate = ["\\"], t.createBlocks = function () { i.createBlocks.call(this), this.ends[x].focus = function () { return this.parent.jQ.addClass("mq-hasCursor"), this.isEmpty() && this.parent.jQ.removeClass("mq-empty"), this }, this.ends[x].blur = function () { return this.parent.jQ.removeClass("mq-hasCursor"), this.isEmpty() && this.parent.jQ.addClass("mq-empty"), this }, this.ends[x].write = function (t, e) { t.show().deleteSelection(), e.match(/[a-z]/i) ? st(e).createLeftOf(t) : (this.parent.renderCommand(t), "\\" === e && this.isEmpty() || this.parent.parent.write(t, e)) }, this.ends[x].keystroke = function (t, e, n) { return "Tab" === t || "Enter" === t || "Spacebar" === t ? (this.parent.renderCommand(n.cursor), void e.preventDefault()) : i.keystroke.apply(this, arguments) } }, t.createLeftOf = function (t) { var e; i.createLeftOf.call(this, t), this._replacedFragment && (e = this.jQ[0], this.jQ = this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove", function (t) { return O(t.target = e).trigger(t), !1 }).insertBefore(this.jQ).add(this.jQ)) }, t.latex = function () { return "\\" + this.ends[x].latex() + " " }, t.renderCommand = function (t) { this.jQ = this.jQ.last(), this.remove(), this[q] ? t.insLeftOf(this[q]) : t.insAtRightEnd(this.parent); var e = this.ends[x].latex(), n = Q[e = e || " "]; n ? (n = n(e), this._replacedFragment && n.replaces(this._replacedFragment), n.createLeftOf(t)) : ((n = lt()).replaces(e), n.createLeftOf(t), t.insRightOf(n), this._replacedFragment && this._replacedFragment.remove()) } }), Q.notin = Q.cong = Q.equiv = Q.oplus = Q.otimes = g(rt, function (t, e) { t.init = function (t) { e.init.call(this, "\\" + t + " ", "&" + t + ";") } }), Q["≠"] = Q.ne = Q.neq = a(rt, "\\ne ", "&ne;"), Q.ast = Q.star = Q.loast = Q.lowast = a(rt, "\\ast ", "&lowast;"), Q.therefor = Q.therefore = a(rt, "\\therefore ", "&there4;"), Q.cuz = Q.because = a(rt, "\\because ", "&#8757;"), Q.prop = Q.propto = a(rt, "\\propto ", "&prop;"), Q["≈"] = Q.asymp = Q.approx = a(rt, "\\approx ", "&asymp;"), Q.isin = Q.in = a(rt, "\\in ", "&isin;"), Q.ni = Q.contains = a(rt, "\\ni ", "&ni;"), Q.notni = Q.niton = Q.notcontains = Q.doesnotcontain = a(rt, "\\not\\ni ", "&#8716;"), Q.sub = Q.subset = a(rt, "\\subset ", "&sub;"), Q.sup = Q.supset = Q.superset = a(rt, "\\supset ", "&sup;"), Q.nsub = Q.notsub = Q.nsubset = Q.notsubset = a(rt, "\\not\\subset ", "&#8836;"), Q.nsup = Q.notsup = Q.nsupset = Q.notsupset = Q.nsuperset = Q.notsuperset = a(rt, "\\not\\supset ", "&#8837;"), Q.sube = Q.subeq = Q.subsete = Q.subseteq = a(rt, "\\subseteq ", "&sube;"), Q.supe = Q.supeq = Q.supsete = Q.supseteq = Q.supersete = Q.superseteq = a(rt, "\\supseteq ", "&supe;"), Q.nsube = Q.nsubeq = Q.notsube = Q.notsubeq = Q.nsubsete = Q.nsubseteq = Q.notsubsete = Q.notsubseteq = a(rt, "\\not\\subseteq ", "&#8840;"), Q.nsupe = Q.nsupeq = Q.notsupe = Q.notsupeq = Q.nsupsete = Q.nsupseteq = Q.notsupsete = Q.notsupseteq = Q.nsupersete = Q.nsuperseteq = Q.notsupersete = Q.notsuperseteq = a(rt, "\\not\\supseteq ", "&#8841;"), Q.N = Q.naturals = Q.Naturals = a(st, "\\mathbb{N}", "&#8469;"), Q.P = Q.primes = Q.Primes = Q.projective = Q.Projective = Q.probability = Q.Probability = a(st, "\\mathbb{P}", "&#8473;"), Q.Z = Q.integers = Q.Integers = a(st, "\\mathbb{Z}", "&#8484;"), Q.Q = Q.rationals = Q.Rationals = a(st, "\\mathbb{Q}", "&#8474;"), Q.R = Q.reals = Q.Reals = a(st, "\\mathbb{R}", "&#8477;"), Q.C = Q.complex = Q.Complex = Q.complexes = Q.Complexes = Q.complexplane = Q.Complexplane = Q.ComplexPlane = a(st, "\\mathbb{C}", "&#8450;"), Q.H = Q.Hamiltonian = Q.quaternions = Q.Quaternions = a(st, "\\mathbb{H}", "&#8461;"), Q.quad = Q.emsp = a(st, "\\quad ", "    "), Q.qquad = a(st, "\\qquad ", "        "), Q.diamond = a(st, "\\diamond ", "&#9671;"), Q.bigtriangleup = a(st, "\\bigtriangleup ", "&#9651;"), Q.ominus = a(st, "\\ominus ", "&#8854;"), Q.uplus = a(st, "\\uplus ", "&#8846;"), Q.bigtriangledown = a(st, "\\bigtriangledown ", "&#9661;"), Q.sqcap = a(st, "\\sqcap ", "&#8851;"), Q.triangleleft = a(st, "\\triangleleft ", "&#8882;"), Q.sqcup = a(st, "\\sqcup ", "&#8852;"), Q.triangleright = a(st, "\\triangleright ", "&#8883;"), Q.odot = Q.circledot = a(st, "\\odot ", "&#8857;"), Q.bigcirc = a(st, "\\bigcirc ", "&#9711;"), Q.dagger = a(st, "\\dagger ", "&#0134;"), Q.ddagger = a(st, "\\ddagger ", "&#135;"), Q.wr = a(st, "\\wr ", "&#8768;"), Q.amalg = a(st, "\\amalg ", "&#8720;"), Q.models = a(st, "\\models ", "&#8872;"), Q.prec = a(st, "\\prec ", "&#8826;"), Q.succ = a(st, "\\succ ", "&#8827;"), Q.preceq = a(st, "\\preceq ", "&#8828;"), Q.succeq = a(st, "\\succeq ", "&#8829;"), Q.simeq = a(st, "\\simeq ", "&#8771;"), Q.mid = a(st, "\\mid ", "&#8739;"), Q.ll = a(st, "\\ll ", "&#8810;"), Q.gg = a(st, "\\gg ", "&#8811;"), Q.parallel = a(st, "\\parallel ", "&#8741;"), Q.nparallel = a(st, "\\nparallel ", "&#8742;"), Q.bowtie = a(st, "\\bowtie ", "&#8904;"), Q.sqsubset = a(st, "\\sqsubset ", "&#8847;"), Q.sqsupset = a(st, "\\sqsupset ", "&#8848;"), Q.smile = a(st, "\\smile ", "&#8995;"), Q.sqsubseteq = a(st, "\\sqsubseteq ", "&#8849;"), Q.sqsupseteq = a(st, "\\sqsupseteq ", "&#8850;"), Q.doteq = a(st, "\\doteq ", "&#8784;"), Q.frown = a(st, "\\frown ", "&#8994;"), Q.vdash = a(st, "\\vdash ", "&#8870;"), Q.dashv = a(st, "\\dashv ", "&#8867;"), Q.nless = a(st, "\\nless ", "&#8814;"), Q.ngtr = a(st, "\\ngtr ", "&#8815;"), Q.longleftarrow = a(st, "\\longleftarrow ", "&#8592;"), Q.longrightarrow = a(st, "\\longrightarrow ", "&#8594;"), Q.Longleftarrow = a(st, "\\Longleftarrow ", "&#8656;"), Q.Longrightarrow = a(st, "\\Longrightarrow ", "&#8658;"), Q.longleftrightarrow = a(st, "\\longleftrightarrow ", "&#8596;"), Q.updownarrow = a(st, "\\updownarrow ", "&#8597;"), Q.Longleftrightarrow = a(st, "\\Longleftrightarrow ", "&#8660;"), Q.Updownarrow = a(st, "\\Updownarrow ", "&#8661;"), Q.mapsto = a(st, "\\mapsto ", "&#8614;"), Q.nearrow = a(st, "\\nearrow ", "&#8599;"), Q.hookleftarrow = a(st, "\\hookleftarrow ", "&#8617;"), Q.hookrightarrow = a(st, "\\hookrightarrow ", "&#8618;"), Q.searrow = a(st, "\\searrow ", "&#8600;"), Q.leftharpoonup = a(st, "\\leftharpoonup ", "&#8636;"), Q.rightharpoonup = a(st, "\\rightharpoonup ", "&#8640;"), Q.swarrow = a(st, "\\swarrow ", "&#8601;"), Q.leftharpoondown = a(st, "\\leftharpoondown ", "&#8637;"), Q.rightharpoondown = a(st, "\\rightharpoondown ", "&#8641;"), Q.nwarrow = a(st, "\\nwarrow ", "&#8598;"), Q.ldots = a(st, "\\ldots ", "&#8230;"), Q.cdots = a(st, "\\cdots ", "&#8943;"), Q.vdots = a(st, "\\vdots ", "&#8942;"), Q.ddots = a(st, "\\ddots ", "&#8945;"), Q.surd = a(st, "\\surd ", "&#8730;"), Q.triangle = a(st, "\\triangle ", "&#9651;"), Q.ell = a(st, "\\ell ", "&#8467;"), Q.top = a(st, "\\top ", "&#8868;"), Q.flat = a(st, "\\flat ", "&#9837;"), Q.natural = a(st, "\\natural ", "&#9838;"), Q.sharp = a(st, "\\sharp ", "&#9839;"), Q.wp = a(st, "\\wp ", "&#8472;"), Q.bot = a(st, "\\bot ", "&#8869;"), Q.clubsuit = a(st, "\\clubsuit ", "&#9827;"), Q.diamondsuit = a(st, "\\diamondsuit ", "&#9826;"), Q.heartsuit = a(st, "\\heartsuit ", "&#9825;"), Q.spadesuit = a(st, "\\spadesuit ", "&#9824;"), Q.parallelogram = a(st, "\\parallelogram ", "&#9649;"), Q.square = a(st, "\\square ", "&#11036;"), Q.oint = a(st, "\\oint ", "&#8750;"), Q.bigcap = a(st, "\\bigcap ", "&#8745;"), Q.bigcup = a(st, "\\bigcup ", "&#8746;"), Q.bigsqcup = a(st, "\\bigsqcup ", "&#8852;"), Q.bigvee = a(st, "\\bigvee ", "&#8744;"), Q.bigwedge = a(st, "\\bigwedge ", "&#8743;"), Q.bigodot = a(st, "\\bigodot ", "&#8857;"), Q.bigotimes = a(st, "\\bigotimes ", "&#8855;"), Q.bigoplus = a(st, "\\bigoplus ", "&#8853;"), Q.biguplus = a(st, "\\biguplus ", "&#8846;"), Q.lfloor = a(st, "\\lfloor ", "&#8970;"), Q.rfloor = a(st, "\\rfloor ", "&#8971;"), Q.lceil = a(st, "\\lceil ", "&#8968;"), Q.rceil = a(st, "\\rceil ", "&#8969;"), Q.opencurlybrace = Q.lbrace = a(st, "\\lbrace ", "{"), Q.closecurlybrace = Q.rbrace = a(st, "\\rbrace ", "}"), Q.lbrack = a(st, "["), Q.rbrack = a(st, "]"), Q.slash = a(st, "/"), Q.vert = a(st, "|"), Q.perp = Q.perpendicular = a(st, "\\perp ", "&perp;"), Q.nabla = Q.del = a(st, "\\nabla ", "&nabla;"), Q.hbar = a(st, "\\hbar ", "&#8463;"), Q.AA = Q.Angstrom = Q.angstrom = a(st, "\\text\\AA ", "&#8491;"), Q.ring = Q.circ = Q.circle = a(st, "\\circ ", "&#8728;"), Q.bull = Q.bullet = a(st, "\\bullet ", "&bull;"), Q.setminus = Q.smallsetminus = a(st, "\\setminus ", "&#8726;"), Q.not = Q["¬"] = Q.neg = a(st, "\\neg ", "&not;"), Q["…"] = Q.dots = Q.ellip = Q.hellip = Q.ellipsis = Q.hellipsis = a(st, "\\dots ", "&hellip;"), Q.converges = Q.darr = Q.dnarr = Q.dnarrow = Q.downarrow = a(st, "\\downarrow ", "&darr;"), Q.dArr = Q.dnArr = Q.dnArrow = Q.Downarrow = a(st, "\\Downarrow ", "&dArr;"), Q.diverges = Q.uarr = Q.uparrow = a(st, "\\uparrow ", "&uarr;"), Q.uArr = Q.Uparrow = a(st, "\\Uparrow ", "&uArr;"), Q.to = a(rt, "\\to ", "&rarr;"), Q.rarr = Q.rightarrow = a(st, "\\rightarrow ", "&rarr;"), Q.implies = a(rt, "\\Rightarrow ", "&rArr;"), Q.rArr = Q.Rightarrow = a(st, "\\Rightarrow ", "&rArr;"), Q.gets = a(rt, "\\gets ", "&larr;"), Q.larr = Q.leftarrow = a(st, "\\leftarrow ", "&larr;"), Q.impliedby = a(rt, "\\Leftarrow ", "&lArr;"), Q.lArr = Q.Leftarrow = a(st, "\\Leftarrow ", "&lArr;"), Q.harr = Q.lrarr = Q.leftrightarrow = a(st, "\\leftrightarrow ", "&harr;"), Q.iff = a(rt, "\\Leftrightarrow ", "&hArr;"), Q.hArr = Q.lrArr = Q.Leftrightarrow = a(st, "\\Leftrightarrow ", "&hArr;"), Q.Re = Q.Real = Q.real = a(st, "\\Re ", "&real;"), Q.Im = Q.imag = Q.image = Q.imagin = Q.imaginary = Q.Imaginary = a(st, "\\Im ", "&image;"), Q.part = Q.partial = a(st, "\\partial ", "&part;"), Q.infty = Q.infin = Q.infinity = a(st, "\\infty ", "&infin;"), Q.alef = Q.alefsym = Q.aleph = Q.alephsym = a(st, "\\aleph ", "&alefsym;"), Q.xist = Q.xists = Q.exist = Q.exists = a(st, "\\exists ", "&exist;"), Q.and = Q.land = Q.wedge = a(st, "\\wedge ", "&and;"), Q.or = Q.lor = Q.vee = a(st, "\\vee ", "&or;"), Q.o = Q.O = Q.empty = Q.emptyset = Q.oslash = Q.Oslash = Q.nothing = Q.varnothing = a(rt, "\\varnothing ", "&empty;"), Q.cup = Q.union = a(rt, "\\cup ", "&cup;"), Q.cap = Q.intersect = Q.intersection = a(rt, "\\cap ", "&cap;"), Q.deg = Q.degree = a(st, "\\degree ", "&deg;"), Q.ang = Q.angle = a(st, "\\angle ", "&ang;"), Q.measuredangle = a(st, "\\measuredangle ", "&#8737;"); var pt = g(st, function (t, e) { t.createLeftOf = function (t) { t.options.autoSubscriptNumerals && t.parent !== t.parent.parent.sub && (t[x] instanceof dt && !1 !== t[x].isItalic || t[x] instanceof Dt && t[x][x] instanceof dt && !1 !== t[x][x].isItalic) ? (Q._().createLeftOf(t), e.createLeftOf.call(this, t), t.insRightOf(t.parent.parent)) : e.createLeftOf.call(this, t) } }), dt = g(it, function (t, n) { t.init = function (t, e) { n.init.call(this, t, "<var>" + (e || t) + "</var>") }, t.text = function () { var t = this.ctrlSeq; return !this[x] || this[x] instanceof dt || this[x] instanceof rt || "\\ " === this[x].ctrlSeq || (t = "*" + t), !this[q] || this[q] instanceof rt || this[q] instanceof Dt || (t += "*"), t } }); A.p.autoCommands = { _maxLength: 0 }, I.autoCommands = function (t) { if (!/^[a-z]+(?: [a-z]+)*$/i.test(t)) throw '"' + t + '" not a space-delimited list of only letters'; for (var e = t.split(" "), n = {}, i = 0, s = 0; s < e.length; s += 1) { var r = e[s]; if (r.length < 2) throw 'autocommand "' + r + '" not minimum length of 2'; if (Q[r] === xt) throw '"' + r + '" is a built-in operator name'; n[r] = 1, i = o(i, r.length) } return n._maxLength = i, n }; var mt = g(dt, function (t, o) { function p(t) { return t instanceof it && !(t instanceof rt) } t.init = function (t) { return o.init.call(this, this.letter = t) }, t.createLeftOf = function (t) { var e = t.options.autoCommands, n = e._maxLength; if (0 < n) { for (var i = this.letter, s = t[x], r = 1; s instanceof mt && r < n;)i = s.letter + i, s = s[x], r += 1; for (; i.length;) { if (e.hasOwnProperty(i)) { for (r = 2, s = t[x]; r < i.length; r += 1, s = s[x]); return j(s, t[x]).remove(), t[x] = s[x], Q[i](i).createLeftOf(t) } i = i.slice(1) } } o.createLeftOf.apply(this, arguments) }, t.italicize = function (t) { return this.isItalic = t, this.jQ.toggleClass("mq-operator-name", !t), this }, t.finalizeTree = t.siblingDeleted = t.siblingCreated = function (t, e) { e !== x && this[q] instanceof mt || this.autoUnItalicize(t) }, t.autoUnItalicize = function (t) { var e = t.autoOperatorNames; if (0 !== e._maxLength) { for (var n = this.letter, i = this[x]; i instanceof mt; i = i[x])n = i.letter + n; for (var s = this[q]; s instanceof mt; s = s[q])n += s.letter; j(i[q] || this.parent.ends[x], s[x] || this.parent.ends[q]).each(function (t) { t.italicize(!0).jQ.removeClass("mq-first mq-last"), t.ctrlSeq = t.letter }); t: for (var r = 0, o = i[q] || this.parent.ends[x]; r < n.length; r += 1, o = o[q])for (var a = d(e._maxLength, n.length - r); 0 < a; --a) { var l = n.slice(r, r + a); if (e.hasOwnProperty(l)) { for (var c = 0, h = o; c < a; c += 1, h = h[q]) { h.italicize(!1); var u = h } var f = gt.hasOwnProperty(l); o.ctrlSeq = (f ? "\\" : "\\operatorname{") + o.ctrlSeq, u.ctrlSeq += f ? " " : "}", bt.hasOwnProperty(l) && u[x][x][x].jQ.addClass("mq-last"), p(o[x]) && o.jQ.addClass("mq-first"), p(u[q]) && u.jQ.addClass("mq-last"), r += a - 1, o = u; continue t } } } } }), gt = {}, vt = A.p.autoOperatorNames = { _maxLength: 9 }, bt = { limsup: 1, liminf: 1, projlim: 1, injlim: 1 }; !function () { for (var t = "arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "), e = 0; e < t.length; e += 1)gt[t[e]] = vt[t[e]] = 1; for (var n = "sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "), e = 0; e < n.length; e += 1)gt[n[e]] = 1; for (var i = "sin cos tan sec cosec csc cotan cot ctg".split(" "), e = 0; e < i.length; e += 1)vt[i[e]] = vt["arc" + i[e]] = vt[i[e] + "h"] = vt["ar" + i[e] + "h"] = vt["arc" + i[e] + "h"] = 1; for (var s = "gcf hcf lcm proj span".split(" "), e = 0; e < s.length; e += 1)vt[s[e]] = 1 }(), I.autoOperatorNames = function (t) { if (!/^[a-z]+(?: [a-z]+)*$/i.test(t)) throw '"' + t + '" not a space-delimited list of only letters'; for (var e = t.split(" "), n = {}, i = 0, s = 0; s < e.length; s += 1) { var r = e[s]; if (r.length < 2) throw '"' + r + '" not minimum length of 2'; n[r] = 1, i = o(i, r.length) } return n._maxLength = i, n }; var wt, xt = g(it, function (t, e) { t.init = function (t) { this.ctrlSeq = t }, t.createLeftOf = function (t) { for (var e = this.ctrlSeq, n = 0; n < e.length; n += 1)mt(e.charAt(n)).createLeftOf(t) }, t.parser = function () { for (var t = this.ctrlSeq, e = ot(), n = 0; n < t.length; n += 1)mt(t.charAt(n)).adopt(e, e.ends[q], 0); return U.succeed(e.children()) } }); for (wt in vt) vt.hasOwnProperty(wt) && (Q[wt] = xt); Q.operatorname = g(nt, function (t) { t.createLeftOf = m, t.numBlocks = function () { return 1 }, t.parser = function () { return J.block.map(function (t) { return t.children() }) } }), Q.f = g(mt, function (t, e) { t.init = function () { it.p.init.call(this, this.letter = "f", '<var class="mq-f">f</var>') }, t.italicize = function (t) { return this.jQ.html("f").toggleClass("mq-f", t), e.italicize.apply(this, arguments) } }), Q[" "] = Q.space = a(st, "\\ ", "&nbsp;"), Q["'"] = Q.prime = a(st, "'", "&prime;"), Q.backslash = a(st, "\\backslash ", "\\"), _["\\"] || (_["\\"] = Q.backslash), Q.$ = a(st, "\\$", "$"); var qt = g(it, function (t, n) { t.init = function (t, e) { n.init.call(this, t, '<span class="mq-nonSymbola">' + (e || t) + "</span>") } }); Q["@"] = qt, Q["&"] = a(qt, "\\&", "&amp;"), Q["%"] = a(qt, "\\%", "%"), Q.alpha = Q.beta = Q.gamma = Q.delta = Q.zeta = Q.eta = Q.theta = Q.iota = Q.kappa = Q.mu = Q.nu = Q.xi = Q.rho = Q.sigma = Q.tau = Q.chi = Q.psi = Q.omega = g(dt, function (t, e) { t.init = function (t) { e.init.call(this, "\\" + t + " ", "&" + t + ";") } }), Q.phi = a(dt, "\\phi ", "&#981;"), Q.phiv = Q.varphi = a(dt, "\\varphi ", "&phi;"), Q.epsilon = a(dt, "\\epsilon ", "&#1013;"), Q.epsiv = Q.varepsilon = a(dt, "\\varepsilon ", "&epsilon;"), Q.piv = Q.varpi = a(dt, "\\varpi ", "&piv;"), Q.sigmaf = Q.sigmav = Q.varsigma = a(dt, "\\varsigma ", "&sigmaf;"), Q.thetav = Q.vartheta = Q.thetasym = a(dt, "\\vartheta ", "&thetasym;"), Q.upsilon = Q.upsi = a(dt, "\\upsilon ", "&upsilon;"), Q.gammad = Q.Gammad = Q.digamma = a(dt, "\\digamma ", "&#989;"), Q.kappav = Q.varkappa = a(dt, "\\varkappa ", "&#1008;"), Q.rhov = Q.varrho = a(dt, "\\varrho ", "&#1009;"), Q.pi = Q["π"] = a(qt, "\\pi ", "&pi;"), Q.lambda = a(qt, "\\lambda ", "&lambda;"), Q.Upsilon = Q.Upsi = Q.upsih = Q.Upsih = a(it, "\\Upsilon ", '<var style="font-family: serif">&upsih;</var>'), Q.Gamma = Q.Delta = Q.Theta = Q.Lambda = Q.Xi = Q.Pi = Q.Sigma = Q.Phi = Q.Psi = Q.Omega = Q.forall = g(st, function (t, e) { t.init = function (t) { e.init.call(this, "\\" + t + " ", "&" + t + ";") } }); var yt = g(nt, function (t) { t.init = function (t) { this.latex = t }, t.createLeftOf = function (t) { var e = J.parse(this.latex); e.children().adopt(t.parent, t[x], t[q]), t[x] = e.ends[q], e.jQize().insertBefore(t.jQ), e.finalizeInsert(t.options, t), e.ends[q][q].siblingCreated && e.ends[q][q].siblingCreated(t.options, x), e.ends[x][x].siblingCreated && e.ends[x][x].siblingCreated(t.options, q), t.parent.bubble("reflow") }, t.parser = function () { var t = J.parse(this.latex).children(); return U.succeed(t) } }); Q["¹"] = a(yt, "^1"), Q["²"] = a(yt, "^2"), Q["³"] = a(yt, "^3"), Q["¼"] = a(yt, "\\frac14"), Q["½"] = a(yt, "\\frac12"), Q["¾"] = a(yt, "\\frac34"), et = g(rt, function (t) { t.init = st.prototype.init, t.contactWeld = t.siblingCreated = t.siblingDeleted = function (t, e) { if (e !== q) return this.jQ[0].className = !this[x] || this[x] instanceof rt ? "" : "mq-binary-operator", this } }), Q["+"] = a(et, "+", "+"), Q["–"] = Q["-"] = a(et, "-", "&minus;"), Q["±"] = Q.pm = Q.plusmn = Q.plusminus = a(et, "\\pm ", "&plusmn;"), Q.mp = Q.mnplus = Q.minusplus = a(et, "\\mp ", "&#8723;"), _["*"] = Q.sdot = Q.cdot = a(rt, "\\cdot ", "&middot;", "*"); var Ot = g(rt, function (t, n) { t.init = function (t, e) { this.data = t; e = (this.strict = e) ? "Strict" : ""; n.init.call(this, t["ctrlSeq" + e], t["html" + e], t["text" + e]) }, t.swap = function (t) { t = (this.strict = t) ? "Strict" : ""; this.ctrlSeq = this.data["ctrlSeq" + t], this.jQ.html(this.data["html" + t]), this.textTemplate = [this.data["text" + t]] }, t.deleteTowards = function (t, e) { if (t === x && !this.strict) return this.swap(!0), void this.bubble("reflow"); n.deleteTowards.apply(this, arguments) } }), qt = { ctrlSeq: "\\le ", html: "&le;", text: "≤", ctrlSeqStrict: "<", htmlStrict: "&lt;", textStrict: "<" }, yt = { ctrlSeq: "\\ge ", html: "&ge;", text: "≥", ctrlSeqStrict: ">", htmlStrict: "&gt;", textStrict: ">" }; Q["<"] = Q.lt = a(Ot, qt, !0), Q[">"] = Q.gt = a(Ot, yt, !0), Q["≤"] = Q.le = Q.leq = a(Ot, qt, !1), Q["≥"] = Q.ge = Q.geq = a(Ot, yt, !1); var kt = g(rt, function (t, e) { t.init = function () { e.init.call(this, "=", "=") }, t.createLeftOf = function (t) { if (t[x] instanceof Ot && t[x].strict) return t[x].swap(!1), void t[x].bubble("reflow"); e.createLeftOf.apply(this, arguments) } }); Q["="] = kt, Q["×"] = Q.times = a(rt, "\\times ", "&times;", "[x]"), Q["÷"] = Q.div = Q.divide = Q.divides = a(rt, "\\div ", "&divide;", "[/]"), _["~"] = Q.sim = a(rt, "\\sim ", "~", "~"); var Ct, Tt, jt, Qt = m, _t = document.createElement("div").style; for (jt in { transform: 1, WebkitTransform: 1, MozTransform: 1, OTransform: 1, msTransform: 1 }) if (jt in _t) { Tt = jt; break } Ct = Tt ? function (t, e, n) { t.css(Tt, "scale(" + e + "," + n + ")") } : "filter" in _t ? (Qt = function (t) { t.className = t.className }, function (t, e, n) { e /= 1 + (n - 1) / 2, t.css("fontSize", n + "em"), t.hasClass("mq-matrixed-container") || t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>'); var i = t.children().css("filter", "progid:DXImageTransform.Microsoft.Matrix(M11=" + e + ",SizingMethod='auto expand')"); function s() { t.css("marginRight", (i.width() - 1) * (e - 1) / e + "px") } s(); var r = setInterval(s); O(window).load(function () { clearTimeout(r), s() }) }) : function (t, e, n) { t.css("fontSize", n + "em") }, et = g(nt, function (t, i) { t.init = function (t, e, n) { i.init.call(this, t, "<" + e + " " + n + ">&0</" + e + ">") } }), Q.mathrm = a(et, "\\mathrm", "span", 'class="mq-roman mq-font"'), Q.mathit = a(et, "\\mathit", "i", 'class="mq-font"'), Q.mathbf = a(et, "\\mathbf", "b", 'class="mq-font"'), Q.mathsf = a(et, "\\mathsf", "span", 'class="mq-sans-serif mq-font"'), Q.mathtt = a(et, "\\mathtt", "span", 'class="mq-monospace mq-font"'), Q.underline = a(et, "\\underline", "span", 'class="mq-non-leaf mq-underline"'), Q.overline = Q.bar = a(et, "\\overline", "span", 'class="mq-non-leaf mq-overline"'), Q.overrightarrow = a(et, "\\overrightarrow", "span", 'class="mq-non-leaf mq-overarrow mq-arrow-right"'), Q.overleftarrow = a(et, "\\overleftarrow", "span", 'class="mq-non-leaf mq-overarrow mq-arrow-left"'), Q.textcolor = g(nt, function (t, s) { t.setColor = function (t) { this.color = t, this.htmlTemplate = '<span class="mq-textcolor" style="color:' + t + '">&0</span>' }, t.latex = function () { return "\\textcolor{" + this.color + "}{" + this.blocks[0].latex() + "}" }, t.parser = function () { var e = this, t = U.optWhitespace, n = U.string, i = U.regex; return t.then(n("{")).then(i(/^[#\w\s.,()%-]*/)).skip(n("}")).then(function (t) { return e.setColor(t), s.parser.call(e) }) } }), Q.class = g(nt, function (t, i) { t.parser = function () { var e = this, t = U.string, n = U.regex; return U.optWhitespace.then(t("{")).then(n(/^[-\w\s\\\xA0-\xFF]*/)).skip(t("}")).then(function (t) { return e.htmlTemplate = '<span class="mq-class ' + t + '">&0</span>', i.parser.call(e) }) } }); var Dt = g(nt, function (t, i) { t.ctrlSeq = "_{...}^{...}", t.createLeftOf = function (t) { if (t[x] || !t.options.supSubsRequireOperand) return i.createLeftOf.apply(this, arguments) }, t.contactWeld = function (t) { for (var i = x; i; i = i === x && q)if (this[i] instanceof Dt) { for (var e = "sub"; e; e = "sub" === e && "sup") { var n, s, r = this[e], o = this[i][e]; r && (o ? r.isEmpty() ? s = k(o, 0, o.ends[x]) : (r.jQ.children().insAtDirEnd(-i, o.jQ), n = r.children().disown(), s = k(o, n.ends[q], o.ends[x]), i === x ? n.adopt(o, o.ends[q], 0) : n.adopt(o, 0, o.ends[x])) : this[i].addBlock(r.disown()), this.placeCursor = function (e, n) { return function (t) { t.insAtDirEnd(-i, e || n) } }(o, r)) } this.remove(), t && t[x] === this && (i === q && s ? s[x] ? t.insRightOf(s[x]) : t.insAtLeftEnd(s.parent) : t.insRightOf(this[i])); break } this.respace() }, A.p.charsThatBreakOutOfSupSub = "", t.finalizeTree = function () { this.ends[x].write = function (t, e) { if (t.options.autoSubscriptNumerals && this === this.parent.sub) { if ("_" === e) return; var n = this.chToCmd(e); return n instanceof it ? t.deleteSelection() : t.clearSelection().insRightOf(this.parent), n.createLeftOf(t.show()) } t[x] && !t[q] && !t.selection && -1 < t.options.charsThatBreakOutOfSupSub.indexOf(e) && t.insRightOf(this.parent), ot.p.write.apply(this, arguments) } }, t.moveTowards = function (t, e, n) { e.options.autoSubscriptNumerals && !this.sup ? e.insDirOf(t, this) : i.moveTowards.apply(this, arguments) }, t.deleteTowards = function (t, e) { var n; e.options.autoSubscriptNumerals && this.sub ? ((n = this.sub.ends[-t]) instanceof it ? n.remove() : n && n.deleteTowards(t, e.insAtDirEnd(-t, this.sub)), this.sub.isEmpty() && (this.sub.deleteOutOf(x, e.insAtLeftEnd(this.sub)), this.sup && e.insDirOf(-t, this))) : i.deleteTowards.apply(this, arguments) }, t.latex = function () { function t(t, e) { var n = e && e.latex(); return e ? t + (1 === n.length ? n : "{" + (n || " ") + "}") : "" } return t("_", this.sub) + t("^", this.sup) }, t.respace = t.siblingCreated = t.siblingDeleted = function (t, e) { e !== q && this.jQ.toggleClass("mq-limit", "\\int " === this[x].ctrlSeq) }, t.addBlock = function (t) { "sub" === this.supsub ? ((this.sup = this.upInto = this.sub.upOutOf = t).adopt(this, this.sub, 0).downOutOf = this.sub, t.jQ = O('<span class="mq-sup"/>').append(t.jQ.children()).attr(p, t.id).prependTo(this.jQ)) : ((this.sub = this.downInto = this.sup.downOutOf = t).adopt(this, 0, this.sup).upOutOf = this.sup, t.jQ = O('<span class="mq-sub"></span>').append(t.jQ.children()).attr(p, t.id).appendTo(this.jQ.removeClass("mq-sup-only")), this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>')); for (var e = 0; e < 2; e += 1)!function (i, s, r, o) { i[s].deleteOutOf = function (t, e) { var n; e.insDirOf(this[t] ? -t : t, this.parent), this.isEmpty() || (n = this.ends[t], this.children().disown().withDirAdopt(t, e.parent, e[t], e[-t]).jQ.insDirOf(-t, e.jQ), e[-t] = n), i.supsub = r, delete i[s], delete i[o + "Into"], i[r][o + "OutOf"] = St, delete i[r].deleteOutOf, "sub" === s && O(i.jQ.addClass("mq-sup-only")[0].lastChild).remove(), this.remove() } }(this, "sub sup".split(" ")[e], "sup sub".split(" ")[e], "down up".split(" ")[e]) } }); function St(t) { var e = this.parent, n = t; do { if (n[q]) return t.insLeftOf(e) } while ((n = n.parent.parent) !== e); t.insRightOf(e) } Q.subscript = Q._ = g(Dt, function (t, e) { t.supsub = "sub", t.htmlTemplate = '<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>', t.textTemplate = ["_"], t.finalizeTree = function () { this.downInto = this.sub = this.ends[x], this.sub.upOutOf = St, e.finalizeTree.call(this) } }), Q.superscript = Q.supscript = Q["^"] = g(Dt, function (t, e) { t.supsub = "sup", t.htmlTemplate = '<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>', t.textTemplate = ["^"], t.finalizeTree = function () { this.upInto = this.sup = this.ends[q], this.sup.downOutOf = St, e.finalizeTree.call(this) } }); var Lt = g(nt, function (t, e) { t.init = function (t, e) { e = '<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>' + e + '</big><span class="mq-from"><span>&0</span></span></span>'; it.prototype.init.call(this, t, e) }, t.createLeftOf = function (t) { e.createLeftOf.apply(this, arguments), t.options.sumStartsWithNEquals && (mt("n").createLeftOf(t), kt().createLeftOf(t)) }, t.latex = function () { function t(t) { return 1 === t.length ? t : "{" + (t || " ") + "}" } return this.ctrlSeq + "_" + t(this.ends[x].latex()) + "^" + t(this.ends[q].latex()) }, t.parser = function () { for (var t = U.string, e = U.optWhitespace, n = U.succeed, i = J.block, s = this, r = s.blocks = [ot(), ot()], o = 0; o < r.length; o += 1)r[o].adopt(s, s.ends[q], 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = r["_" === t ? 0 : 1]; return i.then(function (t) { return t.children().adopt(e, e.ends[q], 0), n(s) }) }).many().result(s) }, t.finalizeTree = function () { this.downInto = this.ends[x], this.upInto = this.ends[q], this.ends[x].upOutOf = this.ends[q], this.ends[q].downOutOf = this.ends[x] } }), qt = g(nt, function (t, e) { t.init = function (t, e) { e = '<span class="mq-non-leaf" style="position: relative;"><span class="integral-fix"><span class="integral-fix" style="position: absolute; top: -6px; left: 24px;"><small>&1</small></span></span>' + e + '<span class="integral-fix"><span class="integral-fix" style = "position: absolute; bottom:-2px; left: 13px"><small>&0</small></span></span></span>'; it.prototype.init.call(this, t, e) }, t.latex = function () { function t(t) { return 1 === t.length ? t : "{" + (t || "") + "}" } return this.ctrlSeq + "_" + t(this.ends[x].latex()) + "^" + t(this.ends[q].latex()) }, t.parser = function () { for (var t = U.string, e = U.optWhitespace, n = U.succeed, i = J.block, s = this, r = s.blocks = [ot(), ot()], o = 0; o < r.length; o += 1)r[o].adopt(s, s.ends[q], 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = r["_" === t ? 0 : 1]; return i.then(function (t) { return t.children().adopt(e, e.ends[q], 0), n(s) }) }).many().result(s) }, t.finalizeTree = function () { this.downInto = this.ends[x], this.upInto = this.ends[q], this.ends[x].upOutOf = this.ends[q], this.ends[q].downOutOf = this.ends[x] } }), yt = g(nt, function (t, e) { t.init = function (t, e) { it.prototype.init.call(this, t, "<big>&0</big>") }, t.latex = function () { return this.ctrlSeq + (1 === (t = this.ends[x].latex()).length ? t : t || "\t"); var t }, t.parser = function () { for (var t = U.string, e = U.optWhitespace, n = U.succeed, i = J.block, s = this, r = s.blocks = [ot(), ot()], o = 0; o < r.length; o += 1)r[o].adopt(s, s.ends[q], 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = r["_" === t ? 0 : 1]; return i.then(function (t) { return t.children().adopt(e, e.ends[q], 0), n(s) }) }).many().result(s) }, t.finalizeTree = function () { this.downInto = this.ends[x], this.upInto = this.ends[q], this.ends[x].upOutOf = this.ends[q], this.ends[q].downOutOf = this.ends[x] } }), et = (g(nt, function (t, e) { t.init = function (t, e) { it.prototype.init.call(this, t, '<span class="mq-non-leaf" style="0.2em; margin-right:0.2em;"><span class="integral-fix"><span class="integral-fix"><small>&1</small></span></span><svg style="height:1em; width:auto;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 500"><rect x="6" y="0" width="15" height="500"/></svg><span class="integral-fix"><span class="integral-fix" style = ""><small>&0</small></span></span></span>') }, t.latex = function () { function t(t) { return 1 === t.length ? t : "{" + (t || "") + "}" } return "\\rvert_" + t(this.ends[x].latex()) + "^" + t(this.ends[q].latex()) }, t.parser = function () { for (var t = U.string, e = U.optWhitespace, n = U.succeed, i = J.block, s = this, r = s.blocks = [ot(), ot()], o = 0; o < r.length; o += 1)r[o].adopt(s, s.ends[q], 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = r["_" === t ? 0 : 1]; return i.then(function (t) { return t.children().adopt(e, e.ends[q], 0), n(s) }) }).many().result(s) }, t.finalizeTree = function () { this.downInto = this.ends[x], this.upInto = this.ends[q], this.ends[x].upOutOf = this.ends[q], this.ends[q].downOutOf = this.ends[x] } }), g(nt, function (t, e) { t.init = function (t, e) { e = '<span class="mq-binary-operator mq-non-leaf"><span style = "margin-bottom: 0px; margin-right:0px !important;">' + e + '</span><div class="mq-from" style = "margin-top: -6px !important;"><small>&0</small></div></span>'; it.prototype.init.call(this, t, e) }, t.latex = function () { return this.ctrlSeq + "_" + (1 === (t = this.ends[x].latex()).length ? t : "{" + (t || " ") + "}"); var t }, t.parser = function () { for (var t = U.string, e = U.optWhitespace, n = U.succeed, i = J.block, s = this, r = s.blocks = [ot(), ot()], o = 0; o < r.length; o += 1)r[o].adopt(s, s.ends[q], 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = r["_" === t ? 0 : 1]; return i.then(function (t) { return t.children().adopt(e, e.ends[q], 0), n(s) }) }).many().result(s) }, t.finalizeTree = function () { this.downInto = this.ends[x], this.upInto = this.ends[q], this.ends[x].upOutOf = this.ends[q], this.ends[q].downOutOf = this.ends[x] } })); Q[""] = Q.lim = Q.limit = a(et, "\\lim ", "lim"), Q[""] = Q.biggr = Q.biggr = a(yt, "\\biggr ", "biggr"), Q[""] = Q.oint = Q.integral = a(qt, "\\oint ", '<svg style="height: 3em; width:auto;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 205 500"> <ellipse style="stroke: rgba(0, 0, 0, 0.19); stroke-width: 0.2px;" cx="189.794" cy="23.362" rx="11.161" ry="11.161"/> <path style="stroke-width: 0.2px; stroke: rgba(0, 0, 0, 0);" d="M 201.025 22.786 C 201.025 22.786 201.433 23.502 200.199 17.337 C 198.965 11.171 190.815 6.182 186.682 4.558 C 182.55 2.934 174.026 0.312 164.536 7.265 C 155.047 14.219 145.475 38.671 145.624 38.641 C 145.023 38.46 135.091 70.272 121.113 129.443 C 107.136 188.615 93.458 256.025 93.679 256.025 C 93.679 256.025 95.229 247.403 88.396 283.589 C 81.563 319.774 79.792 331.922 68.911 392.654 C 58.03 453.385 46.075 491.571 29.14 493.426 C 12.206 495.281 3.438 474.209 3.438 474.209 L 2.327 473.612 C 2.327 473.612 -1.426 487.946 15.809 495.455 C 33.044 502.964 45.246 490.933 48.402 488.8 C 51.558 486.667 66.504 470.384 79.461 420.066 C 92.418 369.748 99.625 337.591 99.625 337.591 C 99.625 337.591 109.043 301.616 120.202 240.329 C 131.361 179.041 140.13 127.49 149.882 78.211 C 159.634 28.931 168.994 13.12 170.662 11.784 C 172.331 10.449 172.998 7.448 178.447 7.336 C 183.896 7.224 190.902 12.563 190.902 12.563 L 201.025 22.786 Z"/> <ellipse style="stroke: rgba(0, 0, 0, 0);" cx="12.981" cy="477.361" rx="11.295" ry="11.295"/> <ellipse style="fill: rgba(216, 216, 216, 0); stroke: rgb(0, 0, 0); stroke-width: 6px;" cx="108.513" cy="245.874" rx="56.564" ry="56.564"/> </svg>'), Q[""] = Q.int = Q.integral = a(qt, "\\int ", '<svg style="height: 3em; width:auto;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 205 500"> <ellipse style="stroke: rgba(0, 0, 0, 0.19); stroke-width: 0.2px;" cx="189.794" cy="23.362" rx="11.161" ry="11.161"/> <path style="stroke-width: 0.2px; stroke: rgba(0, 0, 0, 0);" d="M 201.025 22.786 C 201.025 22.786 201.433 23.502 200.199 17.337 C 198.965 11.171 190.815 6.182 186.682 4.558 C 182.55 2.934 174.026 0.312 164.536 7.265 C 155.047 14.219 145.475 38.671 145.624 38.641 C 145.023 38.46 135.091 70.272 121.113 129.443 C 107.136 188.615 93.458 256.025 93.679 256.025 C 93.679 256.025 95.229 247.403 88.396 283.589 C 81.563 319.774 79.792 331.922 68.911 392.654 C 58.03 453.385 46.075 491.571 29.14 493.426 C 12.206 495.281 3.438 474.209 3.438 474.209 L 2.327 473.612 C 2.327 473.612 -1.426 487.946 15.809 495.455 C 33.044 502.964 45.246 490.933 48.402 488.8 C 51.558 486.667 66.504 470.384 79.461 420.066 C 92.418 369.748 99.625 337.591 99.625 337.591 C 99.625 337.591 109.043 301.616 120.202 240.329 C 131.361 179.041 140.13 127.49 149.882 78.211 C 159.634 28.931 168.994 13.12 170.662 11.784 C 172.331 10.449 172.998 7.448 178.447 7.336 C 183.896 7.224 190.902 12.563 190.902 12.563 L 201.025 22.786 Z"/> <ellipse style="stroke: rgba(0, 0, 0, 0);" cx="12.981" cy="477.361" rx="11.295" ry="11.295"/> </svg>'), Q["∑"] = Q.sum = Q.summation = a(Lt, "\\sum ", "&sum;"), Q["∏"] = Q.prod = Q.product = a(Lt, "\\prod ", "&prod;"), Q.coprod = Q.coproduct = a(Lt, "\\coprod ", "&#8720;"); var qt = Q.frac = Q.dfrac = Q.cfrac = Q.fraction = g(nt, function (t, e) { t.ctrlSeq = "\\frac", t.htmlTemplate = '<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>', t.textTemplate = ["(", ")/(", ")"], t.finalizeTree = function () { this.upInto = this.ends[q].upOutOf = this.ends[x], this.downInto = this.ends[x].downOutOf = this.ends[q] } }), Et = Q.over = _["/"] = g(qt, function (t, n) { t.createLeftOf = function (t) { if (!this.replacedFragment) { for (var e = t[x]; e && !(e instanceof rt || e instanceof (Q.text || m) || e instanceof Lt || "\\ " === e.ctrlSeq || /^[,;:]$/.test(e.ctrlSeq));)e = e[x]; e instanceof Lt && e[q] instanceof Dt && (e = e[q])[q] instanceof Dt && e[q].ctrlSeq != e.ctrlSeq && (e = e[q]), e !== t[x] && (this.replaces(j(e[q] || t.parent.ends[x], t[x])), t[x] = e) } n.createLeftOf.call(this, t) } }), qt = Q.sqrt = Q["√"] = g(nt, function (t, e) { t.ctrlSeq = "\\sqrt", t.htmlTemplate = '<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>', t.textTemplate = ["sqrt(", ")"], t.parser = function () { return J.optBlock.then(function (n) { return J.block.map(function (t) { var e = At(); return e.blocks = [n, t], n.adopt(e, 0, 0), t.adopt(e, n, 0), e }) }).or(e.parser.call(this)) }, t.reflow = function () { var t = this.ends[q].jQ; Ct(t.prev(), 1, t.innerHeight() / +t.css("fontSize").slice(0, -2) - .1) } }), At = (Q.vec = g(nt, function (t, e) { t.ctrlSeq = "\\vec", t.htmlTemplate = '<span class="mq-non-leaf"><span class="mq-vector-prefix">&rarr;</span><span class="mq-vector-stem">&0</span></span>', t.textTemplate = ["vec(", ")"] }), Q.nthroot = g(qt, function (t, e) { t.htmlTemplate = '<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>', t.textTemplate = ["sqrt[", "](", ")"], t.latex = function () { return "\\sqrt[" + this.ends[x].latex() + "]{" + this.ends[q].latex() + "}" } })); function It(t, e) { t.jQadd = function () { e.jQadd.apply(this, arguments), this.delimjQs = this.jQ.children(":first").add(this.jQ.children(":last")), this.contentjQ = this.jQ.children(":eq(1)") }, t.reflow = function () { var t = this.contentjQ.outerHeight() / parseFloat(this.contentjQ.css("fontSize")); Ct(this.delimjQs, d(1 + .2 * (t - 1), 1.2), 1.2 * t) } } var Rt = g(g(nt, It), function (t, r) { t.init = function (t, e, n, i, s) { r.init.call(this, "\\left" + i, u, [e, n]), this.side = t, this.sides = {}, this.sides[x] = { ch: e, ctrlSeq: i }, this.sides[q] = { ch: n, ctrlSeq: s } }, t.numBlocks = function () { return 1 }, t.html = function () { return this.htmlTemplate = '<span class="mq-non-leaf"><span class="mq-scaled mq-paren' + (this.side === q ? " mq-ghost" : "") + '">' + this.sides[x].ch + '</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren' + (this.side === x ? " mq-ghost" : "") + '">' + this.sides[q].ch + "</span></span>", r.html.call(this) }, t.latex = function () { return "\\left" + this.sides[x].ctrlSeq + this.ends[x].latex() + "\\right" + this.sides[q].ctrlSeq }, t.oppBrack = function (t, e, n) { return e instanceof Rt && e.side && e.side !== -n && ("|" === this.sides[this.side].ch || e.side === -this.side) && (!t.restrictMismatchedBrackets || zt[this.sides[this.side].ch] === e.sides[e.side].ch || { "(": "]", "[": ")" }[this.sides[x].ch] === e.sides[q].ch) && e }, t.closeOpposing = function (t) { t.side = 0, t.sides[this.side] = this.sides[this.side], t.delimjQs.eq(this.side === x ? 0 : 1).removeClass("mq-ghost").html(this.sides[this.side].ch) }, t.createLeftOf = function (t) { var e, n; this.replacedFragment || (e = t.options, e = this.oppBrack(e, t[x], x) || this.oppBrack(e, t[q], q) || this.oppBrack(e, t.parent.parent)), e ? (n = this.side = -e.side, this.closeOpposing(e), e === t.parent.parent && t[n] && (j(t[n], t.parent.ends[n], -n).disown().withDirAdopt(-n, e.parent, e, e[n]).jQ.insDirOf(n, e.jQ), e.bubble("reflow"))) : (n = (e = this).side, e.replacedFragment ? e.side = 0 : t[-n] && (e.replaces(j(t[-n], t.parent.ends[-n], n)), t[-n] = 0), r.createLeftOf.call(e, t)), n === x ? t.insAtLeftEnd(e.ends[x]) : t.insRightOf(e) }, t.placeCursor = m, t.unwrap = function () { this.ends[x].children().disown().adopt(this.parent, this, this[q]).jQ.insertAfter(this.jQ), this.remove() }, t.deleteSide = function (t, e, n) { var i = this.parent, s = this[t], r = i.ends[t]; if (t === this.side) return this.unwrap(), void (s ? n.insDirOf(-t, s) : n.insAtDirEnd(t, i)); var o = n.options, a = !this.side; if (this.side = -t, this.oppBrack(o, this.ends[x].ends[this.side], t)) { this.closeOpposing(this.ends[x].ends[this.side]); var l = this.ends[x].ends[t]; this.unwrap(), l.siblingCreated && l.siblingCreated(n.options, t), s ? n.insDirOf(-t, s) : n.insAtDirEnd(t, i) } else { if (this.oppBrack(o, this.parent.parent, t)) this.parent.parent.closeOpposing(this), this.parent.parent.unwrap(); else { if (e && a) return this.unwrap(), void (s ? n.insDirOf(-t, s) : n.insAtDirEnd(t, i)); this.sides[t] = { ch: zt[this.sides[this.side].ch], ctrlSeq: zt[this.sides[this.side].ctrlSeq] }, this.delimjQs.removeClass("mq-ghost").eq(t === x ? 0 : 1).addClass("mq-ghost").html(this.sides[t].ch) } s ? (l = this.ends[x].ends[t], j(s, r, -t).disown().withDirAdopt(-t, this.ends[x], l, 0).jQ.insAtDirEnd(t, this.ends[x].jQ.removeClass("mq-empty")), l.siblingCreated && l.siblingCreated(n.options, t), n.insDirOf(-t, s)) : e ? n.insDirOf(t, this) : n.insAtDirEnd(t, this.ends[x]) } }, t.deleteTowards = function (t, e) { this.deleteSide(-t, !1, e) }, t.finalizeTree = function () { this.ends[x].deleteOutOf = function (t, e) { this.parent.deleteSide(t, !0, e) }, this.finalizeTree = this.intentionalBlur = function () { this.delimjQs.eq(this.side === x ? 1 : 0).removeClass("mq-ghost"), this.side = 0 } }, t.siblingCreated = function (t, e) { e === -this.side && this.finalizeTree() } }), zt = { "(": ")", ")": "(", "[": "]", "]": "[", "{": "}", "}": "{", "\\{": "\\}", "\\}": "\\{", "&lang;": "&rang;", "&rang;": "&lang;", "\\langle ": "\\rangle ", "\\rangle ": "\\langle ", "|": "|" }; function Mt(t, e) { var e = e || t, n = zt[t], i = zt[e]; _[t] = a(Rt, x, t, n, e, i), _[n] = a(Rt, q, t, n, e, i) } Mt("("), Mt("["), Mt("{", "\\{"), Q.langle = a(Rt, x, "&lang;", "&rang;", "\\langle ", "\\rangle "), Q.rangle = a(Rt, q, "&lang;", "&rang;", "\\langle ", "\\rangle "), _["|"] = a(Rt, x, "|", "|", "|", "|"), Q.left = g(nt, function (t) { t.parser = function () { var t = U.regex, e = U.string, r = (U.succeed, U.optWhitespace); return r.then(t(/^(?:[([|]|\\\{)/)).then(function (i) { var s = "\\" === i.charAt(0) ? i.slice(1) : i; return J.then(function (n) { return e("\\right").skip(r).then(t(/^(?:[\])|]|\\\})/)).map(function (t) { var e = "\\" === t.charAt(0) ? t.slice(1) : t, t = Rt(0, s, e, i, t); return t.blocks = [n], n.adopt(t, 0, 0), t }) }) }) } }), Q.right = g(nt, function (t) { t.parser = function () { return U.fail("unmatched \\right") } }), qt = Q.binom = Q.binomial = g(g(nt, It), function (t, e) { t.ctrlSeq = "\\binom", t.htmlTemplate = '<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>', t.textTemplate = ["choose(", ",", ")"] }), Q.choose = g(qt, function (t) { t.createLeftOf = Et.prototype.createLeftOf }), Q.editable = Q.MathQuillMathField = g(nt, function (t, s) { t.ctrlSeq = "\\MathQuillMathField", t.htmlTemplate = '<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>', t.parser = function () { var e = this, t = U.string, n = U.regex, i = U.succeed; return t("[").then(n(/^[a-z][a-z0-9]*/i)).skip(t("]")).map(function (t) { e.name = t }).or(i()).then(s.parser.call(e)) }, t.finalizeTree = function () { var t = L(this.ends[x], this.jQ, A()); t.KIND_OF_MQ = "MathField", t.editable = !0, t.createTextarea(), t.editablesTextareaEvents(), t.cursor.insAtRightEnd(t.root), P(t.root) }, t.registerInnerField = function (t, e) { t.push(t[this.name] = e(this.ends[x].controller)) }, t.latex = function () { return this.ends[x].latex() }, t.text = function () { return this.ends[x].text() } }); var Bt, Ft = Q.embed = g(it, function (t, e) { t.setOptions = function (t) { function e() { return "" } return this.text = t.text || e, this.htmlTemplate = t.htmlString || "", this.latex = t.latex || e, this }, t.parser = function () { var n = this; return string = U.string, regex = U.regex, succeed = U.succeed, string("{").then(regex(/^[a-z][a-z0-9]*/i)).skip(string("}")).then(function (e) { return string("[").then(regex(/^[-\w\s]*/)).skip(string("]")).or(succeed()).map(function (t) { return n.setOptions(z[e](t)) }) }) } }), $t = t(1); for (Bt in $t) !function (t, e) { "function" == typeof e ? (B[t] = function () { return M(), e.apply(this, arguments) }).prototype = e.prototype : B[t] = e }(Bt, $t[Bt]) }();